// Hogan Template Engine wrapper for SocketStream 0.3

var hogan = require('hogan.js');

exports.init = function(root, config) {

  return {

    name: 'Hogan',

    // Opening code to use when a Hogan template is called for the first time
    prefix: function() {
      return '<script type="text/javascript">(function(){var ht=Hogan.Template,t=require(\'socketstream\').tmpl;'
    },

    // Closing code once all Hogan templates have been written into the <script> tag
    suffix: function() {
      return '}).call(this);</script>';
    },

    // Compile template into a function and attach to window.<windowVar>
    process: function(template, path, id) {

      var compiledTemplate = hogan.compile(template, {asString: true});

      return 't[\'' + id + '\']=new ht(' + compiledTemplate + ');';    
    }
  }
}