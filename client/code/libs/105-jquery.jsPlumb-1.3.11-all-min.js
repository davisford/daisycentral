jsPlumbUtil={isArray:function(b){return Object.prototype.toString.call(b)==="[object Array]"},isString:function(a){return typeof a==="string"},isObject:function(a){return Object.prototype.toString.call(a)==="[object Object]"},convertStyle:function(b,a){if("transparent"===b){return b}var g=b,f=function(h){return h.length==1?"0"+h:h},c=function(h){return f(Number(h).toString(16))},d=/(rgb[a]?\()(.*)(\))/;if(b.match(d)){var e=b.match(d)[2].split(",");g="#"+c(e[0])+c(e[1])+c(e[2]);if(!a&&e.length==4){g=g+c(e[3])}}return g},gradient:function(b,a){b=jsPlumbUtil.isArray(b)?b:[b.x,b.y];a=jsPlumbUtil.isArray(a)?a:[a.x,a.y];return(a[1]-b[1])/(a[0]-b[0])},normal:function(b,a){return -1/jsPlumbUtil.gradient(b,a)},lineLength:function(b,a){b=jsPlumbUtil.isArray(b)?b:[b.x,b.y];a=jsPlumbUtil.isArray(a)?a:[a.x,a.y];return Math.sqrt(Math.pow(a[1]-b[1],2)+Math.pow(a[0]-b[0],2))},segment:function(b,a){b=jsPlumbUtil.isArray(b)?b:[b.x,b.y];a=jsPlumbUtil.isArray(a)?a:[a.x,a.y];if(a[0]>b[0]){return(a[1]>b[1])?2:1}else{return(a[1]>b[1])?3:4}},intersects:function(f,e){var c=f.x,a=f.x+f.w,k=f.y,h=f.y+f.h,d=e.x,b=e.x+e.w,i=e.y,g=e.y+e.h;return((c<=d&&d<=a)&&(k<=i&&i<=h))||((c<=b&&b<=a)&&(k<=i&&i<=h))||((c<=d&&d<=a)&&(k<=g&&g<=h))||((c<=b&&d<=a)&&(k<=g&&g<=h))||((d<=c&&c<=b)&&(i<=k&&k<=g))||((d<=a&&a<=b)&&(i<=k&&k<=g))||((d<=c&&c<=b)&&(i<=h&&h<=g))||((d<=a&&c<=b)&&(i<=h&&h<=g))},segmentMultipliers:[null,[1,-1],[1,1],[-1,1],[-1,-1]],inverseSegmentMultipliers:[null,[-1,-1],[-1,1],[1,1],[1,-1]],pointOnLine:function(a,e,b){var d=jsPlumbUtil.gradient(a,e),i=jsPlumbUtil.segment(a,e),h=b>0?jsPlumbUtil.segmentMultipliers[i]:jsPlumbUtil.inverseSegmentMultipliers[i],c=Math.atan(d),f=Math.abs(b*Math.sin(c))*h[1],g=Math.abs(b*Math.cos(c))*h[0];return{x:a.x+g,y:a.y+f}},perpendicularLineTo:function(c,d,e){var b=jsPlumbUtil.gradient(c,d),f=Math.atan(-1/b),g=e/2*Math.sin(f),a=e/2*Math.cos(f);return[{x:d.x+a,y:d.y+g},{x:d.x-a,y:d.y-g}]},findWithFunction:function(b,d){if(b){for(var c=0;c<b.length;c++){if(d(b[c])){return c}}}return -1},indexOf:function(a,b){return jsPlumbUtil.findWithFunction(a,function(c){return c==b})},removeWithFunction:function(c,d){var b=jsPlumbUtil.findWithFunction(c,d);if(b>-1){c.splice(b,1)}return b!=-1},remove:function(b,c){var a=jsPlumbUtil.indexOf(b,c);if(a>-1){b.splice(a,1)}return a!=-1},addWithFunction:function(c,b,a){if(jsPlumbUtil.findWithFunction(c,a)==-1){c.push(b)}},addToList:function(d,b,c){var a=d[b];if(a==null){a=[],d[b]=a}a.push(c);return a},EventGenerator:function(){var c={},b=this;var a=["ready"];this.bind=function(d,e){jsPlumbUtil.addToList(c,d,e);return b};this.fire=function(g,h,d){if(c[g]){for(var f=0;f<c[g].length;f++){if(jsPlumbUtil.findWithFunction(a,function(i){return i===g})!=-1){c[g][f](h,d)}else{try{c[g][f](h,d)}catch(k){jsPlumbUtil.log("jsPlumb: fire failed for event "+g+" : "+k)}}}}return b};this.unbind=function(d){if(d){delete c[d]}else{delete c;c={}}return b};this.getListener=function(d){return c[d]}},logEnabled:true,log:function(){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){try{var b=arguments[arguments.length-1];console.log(b)}catch(a){}}},group:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.group(a)}},groupEnd:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.groupEnd(a)}},time:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.time(a)}},timeEnd:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.timeEnd(a)}}};(function(){var A=!!document.createElement("canvas").getContext,e=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),b=function(){if(b.vml==undefined){var L=document.body.appendChild(document.createElement("div"));L.innerHTML='<v:shape id="vml_flag1" adj="1" />';var K=L.firstChild;K.style.behavior="url(#default#VML)";b.vml=K?typeof K.adj=="object":true;L.parentNode.removeChild(L)}return b.vml};var i=jsPlumbUtil.findWithFunction,J=jsPlumbUtil.indexOf,D=jsPlumbUtil.removeWithFunction,m=jsPlumbUtil.remove,u=jsPlumbUtil.addWithFunction,l=jsPlumbUtil.addToList,n=jsPlumbUtil.isArray,C=jsPlumbUtil.isString,w=jsPlumbUtil.isObject;if(!window.console){window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}}}var x=null,d=function(K,L){return p.CurrentLibrary.getAttribute(F(K),L)},f=function(L,M,K){p.CurrentLibrary.setAttribute(F(L),M,K)},B=function(L,K){p.CurrentLibrary.addClass(F(L),K)},k=function(L,K){return p.CurrentLibrary.hasClass(F(L),K)},o=function(L,K){p.CurrentLibrary.removeClass(F(L),K)},F=function(K){return p.CurrentLibrary.getElementObject(K)},t=function(K){return p.CurrentLibrary.getOffset(F(K))},a=function(K){return p.CurrentLibrary.getSize(F(K))},q=jsPlumbUtil.log,I=jsPlumbUtil.group,h=jsPlumbUtil.groupEnd,H=jsPlumbUtil.time,v=jsPlumbUtil.timeEnd,r=function(){return""+(new Date()).getTime()},E=function(Z){var U=this,aa=arguments,R=false,O=Z.parameters||{},M=U.idPrefix,W=M+(new Date()).getTime(),V=null,ab=null;U._jsPlumb=Z._jsPlumb;U.getId=function(){return W};U.tooltip=Z.tooltip;U.hoverClass=Z.hoverClass||U._jsPlumb.Defaults.HoverClass||p.Defaults.HoverClass;jsPlumbUtil.EventGenerator.apply(this);this.clone=function(){var ac=new Object();U.constructor.apply(ac,aa);return ac};this.getParameter=function(ac){return O[ac]},this.getParameters=function(){return O},this.setParameter=function(ac,ad){O[ac]=ad},this.setParameters=function(ac){O=ac},this.overlayPlacements=[];var N=Z.beforeDetach;this.isDetachAllowed=function(ac){var ad=U._jsPlumb.checkCondition("beforeDetach",ac);if(N){try{ad=N(ac)}catch(ae){q("jsPlumb: beforeDetach callback failed",ae)}}return ad};var Q=Z.beforeDrop;this.isDropAllowed=function(ah,ae,af,ac,ad){var ag=U._jsPlumb.checkCondition("beforeDrop",{sourceId:ah,targetId:ae,scope:af,connection:ac,dropEndpoint:ad});if(Q){try{ag=Q({sourceId:ah,targetId:ae,scope:af,connection:ac,dropEndpoint:ad})}catch(ai){q("jsPlumb: beforeDrop callback failed",ai)}}return ag};var X=function(){if(V&&ab){var ac={};p.extend(ac,V);p.extend(ac,ab);delete U.hoverPaintStyle;if(ac.gradient&&V.fillStyle){delete ac.gradient}ab=ac}};this.setPaintStyle=function(ac,ad){V=ac;U.paintStyleInUse=V;X();if(!ad){U.repaint()}};this.getPaintStyle=function(){return V};this.setHoverPaintStyle=function(ac,ad){ab=ac;X();if(!ad){U.repaint()}};this.getHoverPaintStyle=function(){return ab};this.setHover=function(ac,ae,ad){if(!U._jsPlumb.currentlyDragging&&!U._jsPlumb.isHoverSuspended()){R=ac;if(U.hoverClass!=null&&U.canvas!=null){if(ac){L.addClass(U.canvas,U.hoverClass)}else{L.removeClass(U.canvas,U.hoverClass)}}if(ab!=null){U.paintStyleInUse=ac?ab:V;ad=ad||r();U.repaint({timestamp:ad,recalc:false})}if(U.getAttachedElements&&!ae){Y(ac,r(),U)}}};this.isHover=function(){return R};var L=p.CurrentLibrary,K=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],T={mouseout:"mouseexit"},P=function(ae,af,ad){var ac=T[ad]||ad;L.bind(ae,ad,function(ag){af.fire(ac,af,ag)})},S=function(ae,ad){var ac=T[ad]||ad;L.unbind(ae,ad)};this.attachListeners=function(ad,ae){for(var ac=0;ac<K.length;ac++){P(ad,ae,K[ac])}};var Y=function(ag,af,ac){var ae=U.getAttachedElements();if(ae){for(var ad=0;ad<ae.length;ad++){if(!ac||ac!=ae[ad]){ae[ad].setHover(ag,true,af)}}}};this.reattachListenersForElement=function(ad){if(arguments.length>1){for(var ac=0;ac<K.length;ac++){S(ad,K[ac])}for(var ac=1;ac<arguments.length;ac++){U.attachListeners(ad,arguments[ac])}}}},z=function(P){E.apply(this,arguments);var U=this;this.overlays=[];var N=function(Z){var X=null;if(n(Z)){var W=Z[0],Y=p.extend({component:U,_jsPlumb:U._jsPlumb},Z[1]);if(Z.length==3){p.extend(Y,Z[2])}X=new p.Overlays[U._jsPlumb.getRenderMode()][W](Y);if(Y.events){for(var V in Y.events){X.bind(V,Y.events[V])}}}else{if(Z.constructor==String){X=new p.Overlays[U._jsPlumb.getRenderMode()][Z]({component:U,_jsPlumb:U._jsPlumb})}else{X=Z}}U.overlays.push(X)},O=function(Z){var V=U.defaultOverlayKeys||[],Y=Z.overlays,W=function(aa){return U._jsPlumb.Defaults[aa]||p.Defaults[aa]||[]};if(!Y){Y=[]}for(var X=0;X<V.length;X++){Y.unshift.apply(Y,W(V[X]))}return Y};var L=O(P);if(L){for(var Q=0;Q<L.length;Q++){N(L[Q])}}var K=function(X){var V=-1;for(var W=0;W<U.overlays.length;W++){if(X===U.overlays[W].id){V=W;break}}return V};this.addOverlay=function(V){N(V);U.repaint()};this.getOverlay=function(W){var V=K(W);return V>=0?U.overlays[V]:null};this.getOverlays=function(){return U.overlays};this.hideOverlay=function(W){var V=U.getOverlay(W);if(V){V.hide()}};this.hideOverlays=function(){for(var V=0;V<U.overlays.length;V++){U.overlays[V].hide()}};this.showOverlay=function(W){var V=U.getOverlay(W);if(V){V.show()}};this.showOverlays=function(){for(var V=0;V<U.overlays.length;V++){U.overlays[V].show()}};this.removeAllOverlays=function(){for(var V in U.overlays){U.overlays[V].cleanup()}U.overlays.splice(0,U.overlays.length);U.repaint()};this.removeOverlay=function(W){var V=K(W);if(V!=-1){var X=U.overlays[V];X.cleanup();U.overlays.splice(V,1)}};this.removeOverlays=function(){for(var V=0;V<arguments.length;V++){U.removeOverlay(arguments[V])}};var M="__label",T=function(X){var V={cssClass:X.cssClass,labelStyle:this.labelStyle,id:M,component:U,_jsPlumb:U._jsPlumb},W=p.extend(V,X);return new p.Overlays[U._jsPlumb.getRenderMode()].Label(W)};if(P.label){var R=P.labelLocation||U.defaultLabelLocation||0.5,S=P.labelStyle||U._jsPlumb.Defaults.LabelStyle||p.Defaults.LabelStyle;this.overlays.push(T({label:P.label,location:R,labelStyle:S}))}this.setLabel=function(V){var W=U.getOverlay(M);if(!W){var X=V.constructor==String||V.constructor==Function?{label:V}:V;W=T(X);this.overlays.push(W)}else{if(V.constructor==String||V.constructor==Function){W.setLabel(V)}else{if(V.label){W.setLabel(V.label)}if(V.location){W.setLocation(V.location)}}}if(!U._jsPlumb.isSuspendDrawing()){U.repaint()}};this.getLabel=function(){var V=U.getOverlay(M);return V!=null?V.getLabel():null};this.getLabelOverlay=function(){return U.getOverlay(M)}},G=function(M,K,L){M.bind("click",function(N,O){K.fire("click",K,O)});M.bind("dblclick",function(N,O){K.fire("dblclick",K,O)});M.bind("contextmenu",function(N,O){K.fire("contextmenu",K,O)});M.bind("mouseenter",function(N,O){if(!K.isHover()){L(true);K.fire("mouseenter",K,O)}});M.bind("mouseexit",function(N,O){if(K.isHover()){L(false);K.fire("mouseexit",K,O)}})};var g=0,c=function(){var K=g+1;g++;return K};var y=function(L){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:true,ConnectionOverlays:[],Connector:"Bezier",Container:null,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:false,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};if(L){p.extend(this.Defaults,L)}this.logEnabled=this.Defaults.LogEnabled;jsPlumbUtil.EventGenerator.apply(this);var bs=this,aQ=c(),aT=bs.bind,aG={};for(var aF in this.Defaults){aG[aF]=this.Defaults[aF]}this.bind=function(bC,bB){if("ready"===bC&&N){bB()}else{aT.apply(bs,[bC,bB])}};bs.importDefaults=function(bC){for(var bB in bC){bs.Defaults[bB]=bC[bB]}};bs.restoreDefaults=function(){bs.Defaults=p.extend({},aG)};var R=null,aw=function(){p.repaintEverything()},bu=true,aU=function(){if(bu){aw()}},bk=null,N=false,a3={},aY={},aZ={},al={},bw={},bl={},br={},bA=[],ai=[],U=this.Defaults.Scope,ab=null,Z=function(bE,bC,bD){var bB=bE[bC];if(bB==null){bB=[];bE[bC]=bB}bB.push(bD);return bB},a1=function(bC,bB){if(bs.Defaults.Container){p.CurrentLibrary.appendElement(bC,bs.Defaults.Container)}else{if(!bB){document.body.appendChild(bC)}else{p.CurrentLibrary.appendElement(bC,bB)}}},aH=1,ao=function(){return""+aH++},aN=function(bB){return bB._nodes?bB._nodes:bB},bf=function(bD,bF,bE){if(!bb){var bG=d(bD,"id"),bB=bs.dragManager.getElementsForDraggable(bG);if(bE==null){bE=r()}bs.anchorManager.redraw(bG,bF,bE);if(bB){for(var bC in bB){bs.anchorManager.redraw(bB[bC].id,bF,bE,bB[bC].offset)}}}},aL=function(bC,bE){var bF=null;if(n(bC)){bF=[];for(var bB=0;bB<bC.length;bB++){var bD=F(bC[bB]),bG=d(bD,"id");bF.push(bE(bD,bG))}}else{var bD=F(bC),bG=d(bD,"id");bF=bE(bD,bG)}return bF},az=function(bB){return aZ[bB]},bh=function(bF,bB,bI){var bK=bB==null?false:bB,bG=p.CurrentLibrary;if(bK){if(bG.isDragSupported(bF)&&!bG.isAlreadyDraggable(bF)){var bJ=bI||bs.Defaults.DragOptions||p.Defaults.DragOptions;bJ=p.extend({},bJ);var bH=bG.dragEvents.drag,bC=bG.dragEvents.stop,bE=bG.dragEvents.start;bJ[bE]=aq(bJ[bE],function(){bs.setHoverSuspended(true)});bJ[bH]=aq(bJ[bH],function(){var bL=bG.getUIPosition(arguments);bf(bF,bL);B(bF,"jsPlumb_dragged")});bJ[bC]=aq(bJ[bC],function(){var bL=bG.getUIPosition(arguments);bf(bF,bL);o(bF,"jsPlumb_dragged");bs.setHoverSuspended(false)});var bD=K(bF);br[bD]=true;var bK=br[bD];bJ.disabled=bK==null?false:!bK;bG.initDraggable(bF,bJ,false);bs.dragManager.register(bF)}}},aE=function(bH,bC){var bB=p.extend({},bH);if(bC){p.extend(bB,bC)}if(bB.source&&bB.source.endpoint){bB.sourceEndpoint=bB.source}if(bB.source&&bB.target.endpoint){bB.targetEndpoint=bB.target}if(bH.uuids){bB.sourceEndpoint=az(bH.uuids[0]);bB.targetEndpoint=az(bH.uuids[1])}if(bB.sourceEndpoint&&bB.sourceEndpoint.isFull()){q(bs,"could not add connection; source endpoint is full");return}if(bB.targetEndpoint&&bB.targetEndpoint.isFull()){q(bs,"could not add connection; target endpoint is full");return}if(bB.sourceEndpoint&&bB.sourceEndpoint.connectorOverlays){bB.overlays=bB.overlays||[];for(var bF=0;bF<bB.sourceEndpoint.connectorOverlays.length;bF++){bB.overlays.push(bB.sourceEndpoint.connectorOverlays[bF])}}bB.tooltip=bH.tooltip;if(!bB.tooltip&&bB.sourceEndpoint&&bB.sourceEndpoint.connectorTooltip){bB.tooltip=bB.sourceEndpoint.connectorTooltip}if(bB.target&&!bB.target.endpoint&&!bB.targetEndpoint&&!bB.newConnection){var bG=K(bB.target),bI=a4[bG],bD=aM[bG];if(bI){if(!an[bG]){return}var bE=bD!=null?bD:bs.addEndpoint(bB.target,bI);if(bm[bG]){aM[bG]=bE}bB.targetEndpoint=bE;bE._makeTargetCreator=true}}if(bB.source&&!bB.source.endpoint&&!bB.sourceEndpoint&&!bB.newConnection){var bG=K(bB.source),bI=aD[bG],bD=a8[bG];if(bI){if(!ag[bG]){return}var bE=bD!=null?bD:bs.addEndpoint(bB.source,bI);if(be[bG]){a8[bG]=bE}bB.sourceEndpoint=bE}}return bB},ah=function(bF){var bE=bs.Defaults.ConnectionType||bs.getDefaultConnectionType(),bD=bs.Defaults.EndpointType||aj,bC=p.CurrentLibrary.getParent;if(bF.container){bF.parent=bF.container}else{if(bF.sourceEndpoint){bF.parent=bF.sourceEndpoint.parent}else{if(bF.source.constructor==bD){bF.parent=bF.source.parent}else{bF.parent=bC(bF.source)}}}bF._jsPlumb=bs;var bB=new bE(bF);bB.id="con_"+ao();by("click","click",bB);by("dblclick","dblclick",bB);by("contextmenu","contextmenu",bB);return bB},bz=function(bD,bE,bB){bE=bE||{};if(!bD.suspendedEndpoint){Z(a3,bD.scope,bD)}if(!bE.doNotFireConnectionEvent&&bE.fireEvent!==false){var bC={connection:bD,source:bD.source,target:bD.target,sourceId:bD.sourceId,targetId:bD.targetId,sourceEndpoint:bD.endpoints[0],targetEndpoint:bD.endpoints[1]};bs.fire("jsPlumbConnection",bC,bB);bs.fire("connection",bC,bB)}bs.anchorManager.newConnection(bD);bf(bD.source)},by=function(bB,bC,bD){bD.bind(bB,function(bF,bE){bs.fire(bC,bD,bE)})},aA=function(bD){if(bD.container){return bD.container}else{var bB=p.CurrentLibrary.getTagName(bD.source),bC=p.CurrentLibrary.getParent(bD.source);if(bB&&bB.toLowerCase()==="td"){return p.CurrentLibrary.getParent(bC)}else{return bC}}},aJ=function(bD){var bC=bs.Defaults.EndpointType||aj;bD.parent=aA(bD);bD._jsPlumb=bs;var bB=new bC(bD);bB.id="ep_"+ao();by("click","endpointClick",bB);by("dblclick","endpointDblClick",bB);by("contextmenu","contextmenu",bB);return bB},Y=function(bD,bG,bF){var bB=aY[bD];if(bB&&bB.length){for(var bE=0;bE<bB.length;bE++){for(var bC=0;bC<bB[bE].connections.length;bC++){var bH=bG(bB[bE].connections[bC]);if(bH){return}}if(bF){bF(bB[bE])}}}},ac=function(bC){for(var bB in aY){Y(bB,bC)}},ay=function(bB,bC){if(bB!=null&&bB.parentNode!=null){bB.parentNode.removeChild(bB)}},a2=function(bD,bC){for(var bB=0;bB<bD.length;bB++){ay(bD[bB],bC)}},bp=function(bC,bB){return aL(bC,function(bD,bE){br[bE]=bB;if(p.CurrentLibrary.isDragSupported(bD)){p.CurrentLibrary.setDraggable(bD,bB)}})},a9=function(bD,bE,bB){bE=bE==="block";var bC=null;if(bB){if(bE){bC=function(bG){bG.setVisible(true,true,true)}}else{bC=function(bG){bG.setVisible(false,true,true)}}}var bF=d(bD,"id");Y(bF,function(bH){if(bE&&bB){var bG=bH.sourceId===bF?1:0;if(bH.endpoints[bG].isVisible()){bH.setVisible(true)}}else{bH.setVisible(bE)}},bC)},bn=function(bB){return aL(bB,function(bD,bC){var bE=br[bC]==null?false:br[bC];bE=!bE;br[bC]=bE;p.CurrentLibrary.setDraggable(bD,bE);return bE})},aV=function(bB,bD){var bC=null;if(bD){bC=function(bE){var bF=bE.isVisible();bE.setVisible(!bF)}}Y(bB,function(bF){var bE=bF.isVisible();bF.setVisible(!bE)},bC)},aa=function(bG){var bE=bG.timestamp,bB=bG.recalc,bF=bG.offset,bC=bG.elId;if(!bB){if(bE&&bE===bw[bC]){return al[bC]}}if(bB||!bF){var bD=F(bC);if(bD!=null){ai[bC]=a(bD);al[bC]=t(bD);bw[bC]=bE}}else{al[bC]=bF;if(ai[bC]==null){var bD=F(bC);if(bD!=null){ai[bC]=a(bD)}}}if(al[bC]&&!al[bC].right){al[bC].right=al[bC].left+ai[bC][0];al[bC].bottom=al[bC].top+ai[bC][1];al[bC].width=ai[bC][0];al[bC].height=ai[bC][1];al[bC].centerx=al[bC].left+(al[bC].width/2);al[bC].centery=al[bC].top+(al[bC].height/2)}return al[bC]},aS=function(bB){var bC=al[bB];if(!bC){bC=aa({elId:bB})}return{o:bC,s:ai[bB]}},K=function(bB,bC,bE){var bD=F(bB);var bF=d(bD,"id");if(!bF||bF=="undefined"){if(arguments.length==2&&arguments[1]!=undefined){bF=bC}else{if(arguments.length==1||(arguments.length==3&&!arguments[2])){bF="jsPlumb_"+aQ+"_"+ao()}}f(bD,"id",bF)}return bF},aq=function(bD,bB,bC){bD=bD||function(){};bB=bB||function(){};return function(){var bE=null;try{bE=bB.apply(this,arguments)}catch(bF){q(bs,"jsPlumb function failed : "+bF)}if(bC==null||(bE!==bC)){try{bD.apply(this,arguments)}catch(bF){q(bs,"wrapped function failed : "+bF)}}return bE}};this.connectorClass="_jsPlumb_connector";this.endpointClass="_jsPlumb_endpoint";this.overlayClass="_jsPlumb_overlay";this.Anchors={};this.Connectors={canvas:{},svg:{},vml:{}};this.Endpoints={canvas:{},svg:{},vml:{}};this.Overlays={canvas:{},svg:{},vml:{}};this.addClass=function(bC,bB){return p.CurrentLibrary.addClass(bC,bB)};this.removeClass=function(bC,bB){return p.CurrentLibrary.removeClass(bC,bB)};this.hasClass=function(bC,bB){return p.CurrentLibrary.hasClass(bC,bB)};this.addEndpoint=function(bD,bE,bN){bN=bN||{};var bC=p.extend({},bN);p.extend(bC,bE);bC.endpoint=bC.endpoint||bs.Defaults.Endpoint||p.Defaults.Endpoint;bC.paintStyle=bC.paintStyle||bs.Defaults.EndpointStyle||p.Defaults.EndpointStyle;bD=aN(bD);var bF=[],bI=bD.length&&bD.constructor!=String?bD:[bD];for(var bG=0;bG<bI.length;bG++){var bL=F(bI[bG]),bB=K(bL);bC.source=bL;aa({elId:bB});var bK=aJ(bC);if(bC.parentAnchor){bK.parentAnchor=bC.parentAnchor}Z(aY,bB,bK);var bJ=al[bB],bH=ai[bB];var bM=bK.anchor.compute({xy:[bJ.left,bJ.top],wh:bH,element:bK});bK.paint({anchorLoc:bM});bF.push(bK);bs.dragManager.endpointAdded(bL)}return bF.length==1?bF[0]:bF};this.addEndpoints=function(bF,bC,bB){var bE=[];for(var bD=0;bD<bC.length;bD++){var bG=bs.addEndpoint(bF,bC[bD],bB);if(n(bG)){Array.prototype.push.apply(bE,bG)}else{bE.push(bG)}}return bE};this.animate=function(bD,bC,bB){var bE=F(bD),bH=d(bD,"id");bB=bB||{};var bG=p.CurrentLibrary.dragEvents.step;var bF=p.CurrentLibrary.dragEvents.complete;bB[bG]=aq(bB[bG],function(){bs.repaint(bH)});bB[bF]=aq(bB[bF],function(){bs.repaint(bH)});p.CurrentLibrary.animate(bE,bC,bB)};this.checkCondition=function(bD,bF){var bB=bs.getListener(bD);var bE=true;if(bB&&bB.length>0){try{for(var bC=0;bC<bB.length;bC++){bE=bE&&bB[bC](bF)}}catch(bG){q(bs,"cannot check condition ["+bD+"]"+bG)}}return bE};this.connect=function(bE,bC){var bB=aE(bE,bC);if(bB){if(bB.deleteEndpointsOnDetach==null){bB.deleteEndpointsOnDetach=true}var bD=ah(bB);bz(bD,bB);return bD}};this.deleteEndpoint=function(bC){var bH=(typeof bC=="string")?aZ[bC]:bC;if(bH){var bE=bH.getUuid();if(bE){aZ[bE]=null}bH.detachAll();a2(bH.endpoint.getDisplayElements());bs.anchorManager.deleteEndpoint(bH);for(var bG in aY){var bB=aY[bG];if(bB){var bF=[];for(var bD=0;bD<bB.length;bD++){if(bB[bD]!=bH){bF.push(bB[bD])}}aY[bG]=bF}}bs.dragManager.endpointDeleted(bH)}};this.deleteEveryEndpoint=function(){bs.setSuspendDrawing(true);for(var bD in aY){var bB=aY[bD];if(bB&&bB.length){for(var bC=0;bC<bB.length;bC++){bs.deleteEndpoint(bB[bC])}}}delete aY;aY={};delete aZ;aZ={};bs.setSuspendDrawing(false,true)};var bc=function(bE,bG,bB){var bD=bs.Defaults.ConnectionType||bs.getDefaultConnectionType(),bC=bE.constructor==bD,bF=bC?{connection:bE,source:bE.source,target:bE.target,sourceId:bE.sourceId,targetId:bE.targetId,sourceEndpoint:bE.endpoints[0],targetEndpoint:bE.endpoints[1]}:bE;if(bG){bs.fire("jsPlumbConnectionDetached",bF,bB);bs.fire("connectionDetached",bF,bB)}bs.anchorManager.connectionDetached(bF)},ba=function(bB){bs.fire("connectionDrag",bB)},aW=function(bB){bs.fire("connectionDragStop",bB)};this.detach=function(){if(arguments.length==0){return}var bF=bs.Defaults.ConnectionType||bs.getDefaultConnectionType(),bG=arguments[0].constructor==bF,bE=arguments.length==2?bG?(arguments[1]||{}):arguments[0]:arguments[0],bJ=(bE.fireEvent!==false),bD=bE.forceDetach,bC=bG?arguments[0]:bE.connection;if(bC){if(bD||(bC.isDetachAllowed(bC)&&bC.endpoints[0].isDetachAllowed(bC)&&bC.endpoints[1].isDetachAllowed(bC))){if(bD||bs.checkCondition("beforeDetach",bC)){bC.endpoints[0].detach(bC,false,true,bJ)}}}else{var bB=p.extend({},bE);if(bB.uuids){az(bB.uuids[0]).detachFrom(az(bB.uuids[1]),bJ)}else{if(bB.sourceEndpoint&&bB.targetEndpoint){bB.sourceEndpoint.detachFrom(bB.targetEndpoint)}else{var bI=K(bB.source),bH=K(bB.target);Y(bI,function(bK){if((bK.sourceId==bI&&bK.targetId==bH)||(bK.targetId==bI&&bK.sourceId==bH)){if(bs.checkCondition("beforeDetach",bK)){bK.endpoints[0].detach(bK,false,true,bJ)}}})}}}};this.detachAllConnections=function(bD,bE){bE=bE||{};bD=F(bD);var bF=d(bD,"id"),bB=aY[bF];if(bB&&bB.length){for(var bC=0;bC<bB.length;bC++){bB[bC].detachAll(bE.fireEvent)}}};this.detachEveryConnection=function(bD){bD=bD||{};for(var bE in aY){var bB=aY[bE];if(bB&&bB.length){for(var bC=0;bC<bB.length;bC++){bB[bC].detachAll(bD.fireEvent)}}}delete a3;a3={}};this.draggable=function(bD,bB){if(typeof bD=="object"&&bD.length){for(var bC=0;bC<bD.length;bC++){var bE=F(bD[bC]);if(bE){bh(bE,true,bB)}}}else{if(bD._nodes){for(var bC=0;bC<bD._nodes.length;bC++){var bE=F(bD._nodes[bC]);if(bE){bh(bE,true,bB)}}}else{var bE=F(bD);if(bE){bh(bE,true,bB)}}}};this.extend=function(bC,bB){return p.CurrentLibrary.extend(bC,bB)};this.getDefaultEndpointType=function(){return aj};this.getDefaultConnectionType=function(){return aB};var bv=function(bF,bE,bC,bB){for(var bD=0;bD<bF.length;bD++){bF[bD][bE].apply(bF[bD],bC)}return bB(bF)},W=function(bF,bE,bC){var bB=[];for(var bD=0;bD<bF.length;bD++){bB.push([bF[bD][bE].apply(bF[bD],bC),bF[bD]])}return bB},ar=function(bD,bC,bB){return function(){return bv(bD,bC,arguments,bB)}},aC=function(bC,bB){return function(){return W(bC,bB,arguments)}},bx=function(bB,bE){var bD=[];if(bB){if(typeof bB=="string"){if(bB==="*"){return bB}bD.push(bB)}else{if(bE){bD=bB}else{for(var bC=0;bC<bB.length;bC++){bD.push(K(F(bB[bC])))}}}}return bD},aK=function(bD,bC,bB){if(bD==="*"){return true}return bD.length>0?J(bD,bC)!=-1:!bB};this.getConnections=function(bK,bC){if(!bK){bK={}}else{if(bK.constructor==String){bK={scope:bK}}}var bJ=bK.scope||bs.getDefaultScope(),bI=bx(bJ,true),bB=bx(bK.source),bG=bx(bK.target),bF=(!bC&&bI.length>1)?{}:[],bL=function(bN,bO){if(!bC&&bI.length>1){var bM=bF[bN];if(bM==null){bM=[];bF[bN]=bM}bM.push(bO)}else{bF.push(bO)}};for(var bE in a3){if(aK(bI,bE)){for(var bD=0;bD<a3[bE].length;bD++){var bH=a3[bE][bD];if(aK(bB,bH.sourceId)&&aK(bG,bH.targetId)){bL(bE,bH)}}}}return bF};var O=function(bB,bC){return function(bE){for(var bD=0;bD<bB.length;bD++){bE(bB[bD])}return bC(bB)}},S=function(bB){return function(bC){return bB[bC]}};var T=function(bB,bC){return{setHover:ar(bB,"setHover",bC),removeAllOverlays:ar(bB,"removeAllOverlays",bC),setLabel:ar(bB,"setLabel",bC),addOverlay:ar(bB,"addOverlay",bC),removeOverlay:ar(bB,"removeOverlay",bC),removeOverlays:ar(bB,"removeOverlays",bC),showOverlay:ar(bB,"showOverlay",bC),hideOverlay:ar(bB,"hideOverlay",bC),showOverlays:ar(bB,"showOverlays",bC),hideOverlays:ar(bB,"hideOverlays",bC),setPaintStyle:ar(bB,"setPaintStyle",bC),setHoverPaintStyle:ar(bB,"setHoverPaintStyle",bC),setParameter:ar(bB,"setParameter",bC),setParameters:ar(bB,"setParameters",bC),getLabel:aC(bB,"getLabel"),getOverlay:aC(bB,"getOverlay"),isHover:aC(bB,"isHover"),getParameter:aC(bB,"getParameter"),getParameters:aC(bB,"getParameters"),getPaintStyle:aC(bB,"getPaintStyle"),getHoverPaintStyle:aC(bB,"getHoverPaintStyle"),length:bB.length,each:O(bB,bC),get:S(bB)}};var aP=function(bC){var bB=T(bC,aP);return p.CurrentLibrary.extend(bB,{setDetachable:ar(bC,"setDetachable",aP),setConnector:ar(bC,"setConnector",aP),detach:function(){for(var bD=0;bD<bC.length;bD++){bs.detach(bC[bD])}},isDetachable:aC(bC,"isDetachable")})};var bg=function(bC){var bB=T(bC,aP);return p.CurrentLibrary.extend(bB,{detachAll:function(){for(var bD=0;bD<bC.length;bD++){bC[bD].detachAll()}},"delete":function(){for(var bD=0;bD<bC.length;bD++){bs.deleteEndpoint(bC[bD])}}})};this.select=function(bB){bB=bB||{};bB.scope=bB.scope||"*";var bC=bs.getConnections(bB,true);return aP(bC)};this.selectEndpoints=function(bJ){bJ=bJ||{};bJ.scope=bJ.scope||"*";var bO=!bJ.element&&!bJ.source&&!bJ.target,bC=bO?"*":bx(bJ.element),bD=bO?"*":bx(bJ.source),bL=bO?"*":bx(bJ.target),bQ=bx(bJ.scope,true);var bR=[];for(var bH in aY){var bF=aK(bC,bH,true),bB=aK(bD,bH,true),bG=bD!="*",bM=aK(bL,bH,true),bE=bL!="*";if(bF||bB||bM){inner:for(var bK=0;bK<aY[bH].length;bK++){var bN=aY[bH][bK];if(aK(bQ,bN.scope,true)){var bP=(bG&&bD.length>0&&!bN.isSource),bI=(bE&&bL.length>0&&!bN.isTarget);if(bP||bI){continue inner}bR.push(bN)}}}}return bg(bR)};this.getAllConnections=function(){return a3};this.getDefaultScope=function(){return U};this.getEndpoint=az;this.getEndpoints=function(bB){return aY[K(bB)]};this.getId=K;this.getOffset=function(bC){var bB=al[bC];return aa({elId:bC})};this.getSelector=function(bB){return p.CurrentLibrary.getSelector(bB)};this.getSize=function(bC){var bB=ai[bC];if(!bB){aa({elId:bC})}return ai[bC]};this.appendElement=a1;var aX=false;this.isHoverSuspended=function(){return aX};this.setHoverSuspended=function(bB){aX=bB};this.isCanvasAvailable=function(){return A};this.isSVGAvailable=function(){return e};this.isVMLAvailable=b;this.hide=function(bB,bC){a9(bB,"none",bC)};this.idstamp=ao;this.init=function(){if(!N){bs.setRenderMode(bs.Defaults.RenderMode);var bB=function(bC){p.CurrentLibrary.bind(document,bC,function(bI){if(!bs.currentlyDragging&&ab==p.CANVAS){for(var bH in a3){var bJ=a3[bH];for(var bF=0;bF<bJ.length;bF++){var bE=bJ[bF].connector[bC](bI);if(bE){return}}}for(var bG in aY){var bD=aY[bG];for(var bF=0;bF<bD.length;bF++){if(bD[bF].endpoint[bC](bI)){return}}}}})};bB("click");bB("dblclick");bB("mousemove");bB("mousedown");bB("mouseup");bB("contextmenu");N=true;bs.fire("ready")}};this.log=R;this.jsPlumbUIComponent=E;this.makeAnchor=function(){if(arguments.length==0){return null}var bG=arguments[0],bD=arguments[1],bC=arguments[2],bE=null;if(bG.compute&&bG.getOrientation){return bG}else{if(typeof bG=="string"){bE=p.Anchors[arguments[0]]({elementId:bD,jsPlumbInstance:bs})}else{if(n(bG)){if(n(bG[0])||C(bG[0])){if(bG.length==2&&C(bG[0])&&w(bG[1])){var bB=p.extend({elementId:bD,jsPlumbInstance:bs},bG[1]);bE=p.Anchors[bG[0]](bB)}else{bE=new av(bG,null,bD)}}else{var bF={x:bG[0],y:bG[1],orientation:(bG.length>=4)?[bG[2],bG[3]]:[0,0],offsets:(bG.length==6)?[bG[4],bG[5]]:[0,0],elementId:bD};bE=new ae(bF);bE.clone=function(){return new ae(bF)}}}}}if(!bE.id){bE.id="anchor_"+ao()}return bE};this.makeAnchors=function(bE,bC,bB){var bF=[];for(var bD=0;bD<bE.length;bD++){if(typeof bE[bD]=="string"){bF.push(p.Anchors[bE[bD]]({elementId:bC,jsPlumbInstance:bB}))}else{if(n(bE[bD])){bF.push(bs.makeAnchor(bE[bD],bC,bB))}}}return bF};this.makeDynamicAnchor=function(bB,bC){return new av(bB,bC)};var a4={},aM={},bm={},au={},af=function(bB,bC){bB.paintStyle=bB.paintStyle||bs.Defaults.EndpointStyles[bC]||bs.Defaults.EndpointStyle||p.Defaults.EndpointStyles[bC]||p.Defaults.EndpointStyle;bB.hoverPaintStyle=bB.hoverPaintStyle||bs.Defaults.EndpointHoverStyles[bC]||bs.Defaults.EndpointHoverStyle||p.Defaults.EndpointHoverStyles[bC]||p.Defaults.EndpointHoverStyle;bB.anchor=bB.anchor||bs.Defaults.Anchors[bC]||bs.Defaults.Anchor||p.Defaults.Anchors[bC]||p.Defaults.Anchor;bB.endpoint=bB.endpoint||bs.Defaults.Endpoints[bC]||bs.Defaults.Endpoint||p.Defaults.Endpoints[bC]||p.Defaults.Endpoint};this.makeTarget=function(bE,bF,bL){var bC=p.extend({_jsPlumb:bs},bL);p.extend(bC,bF);af(bC,1);var bJ=p.CurrentLibrary,bK=bC.scope||bs.Defaults.Scope,bG=!(bC.deleteEndpointsOnDetach===false),bD=bC.maxConnections||-1,bB=bC.onMaxConnections;_doOne=function(bQ){var bO=K(bQ);a4[bO]=bC;bm[bO]=bC.uniqueEndpoint,au[bO]=bD,an[bO]=true,proxyComponent=new E(bC);var bN=p.extend({},bC.dropOptions||{}),bM=function(){var bT=p.CurrentLibrary.getDropEvent(arguments),bV=bs.select({target:bO}).length;bs.currentlyDragging=false;var b5=F(bJ.getDragObject(arguments)),bU=d(b5,"dragId"),b3=d(b5,"originalScope"),b0=bl[bU],bS=b0.endpoints[0],bR=bC.endpoint?p.extend({},bC.endpoint):{};if(!an[bO]||au[bO]>0&&bV>=au[bO]){console.log("target element "+bO+" is full.");if(bB){bB({element:bQ,connection:b0},bT)}return false}bS.anchor.locked=false;if(b3){bJ.setDragScope(b5,b3)}var bY=proxyComponent.isDropAllowed(b0.sourceId,K(bQ),b0.scope,b0,null);if(b0.endpointsToDeleteOnDetach){if(bS===b0.endpointsToDeleteOnDetach[0]){b0.endpointsToDeleteOnDetach[0]=null}else{if(bS===b0.endpointsToDeleteOnDetach[1]){b0.endpointsToDeleteOnDetach[1]=null}}}if(b0.suspendedEndpoint){b0.targetId=b0.suspendedEndpoint.elementId;b0.target=bJ.getElementObject(b0.suspendedEndpoint.elementId);b0.endpoints[1]=b0.suspendedEndpoint}if(bY){bS.detach(b0,false,true,false);var b4=aM[bO]||bs.addEndpoint(bQ,bC);if(bC.uniqueEndpoint){aM[bO]=b4}b4._makeTargetCreator=true;if(b4.anchor.positionFinder!=null){var b1=bJ.getUIPosition(arguments),bX=bJ.getOffset(bQ),b2=bJ.getSize(bQ),bW=b4.anchor.positionFinder(b1,bX,b2,b4.anchor.constructorParams);b4.anchor.x=bW[0];b4.anchor.y=bW[1]}var bZ=bs.connect({source:bS,target:b4,scope:b3,previousConnection:b0,container:b0.parent,deleteEndpointsOnDetach:bG,doNotFireConnectionEvent:bS.endpointWillMoveAfterConnection});if(b0.endpoints[1]._makeTargetCreator&&b0.endpoints[1].connections.length<2){bs.deleteEndpoint(b0.endpoints[1])}if(bG){bZ.endpointsToDeleteOnDetach=[bS,b4]}bZ.repaint()}else{if(b0.suspendedEndpoint){if(bS.isReattach){b0.setHover(false);b0.floatingAnchorIndex=null;b0.suspendedEndpoint.addConnection(b0);bs.repaint(bS.elementId)}else{bS.detach(b0,false,true,true,bT)}}}};var bP=bJ.dragEvents.drop;bN.scope=bN.scope||bK;bN[bP]=aq(bN[bP],bM);bJ.initDroppable(bQ,bN,true)};bE=aN(bE);var bI=bE.length&&bE.constructor!=String?bE:[bE];for(var bH=0;bH<bI.length;bH++){_doOne(F(bI[bH]))}return bs};this.unmakeTarget=function(bC,bD){bC=p.CurrentLibrary.getElementObject(bC);var bB=K(bC);if(!bD){delete a4[bB];delete bm[bB];delete au[bB];delete an[bB]}return bs};this.makeTargets=function(bD,bE,bB){for(var bC=0;bC<bD.length;bC++){bs.makeTarget(bD[bC],bE,bB)}};var aD={},a8={},be={},ag={},M={},Q={},an={};this.makeSource=function(bF,bG,bK){var bD=p.extend({},bK);p.extend(bD,bG);af(bD,0);var bJ=p.CurrentLibrary,bE=bD.maxConnections||-1,bC=bD.onMaxConnections,bB=function(bS){var bM=K(bS),bT=bD.parent,bL=bT!=null?bs.getId(bJ.getElementObject(bT)):bM;aD[bL]=bD;be[bL]=bD.uniqueEndpoint;ag[bL]=true;var bN=bJ.dragEvents.stop,bR=bJ.dragEvents.drag,bU=p.extend({},bD.dragOptions||{}),bP=bU.drag,bV=bU.stop,bW=null,bQ=false;Q[bL]=bE;bU.scope=bU.scope||bD.scope;bU[bR]=aq(bU[bR],function(){if(bP){bP.apply(this,arguments)}bQ=false});bU[bN]=aq(bU[bN],function(){if(bV){bV.apply(this,arguments)}bs.currentlyDragging=false;if(bW.connections.length==0){bs.deleteEndpoint(bW)}else{bJ.unbind(bW.canvas,"mousedown");var bY=bD.anchor||bs.Defaults.Anchor,bZ=bW.anchor,b1=bW.connections[0];bW.anchor=bs.makeAnchor(bY,bM,bs);if(bD.parent){var b0=bJ.getElementObject(bD.parent);if(b0){var bX=bW.elementId;var b2=bD.container||bs.Defaults.Container||p.Defaults.Container;bW.setElement(b0,b2);bW.endpointWillMoveAfterConnection=false;bs.anchorManager.rehomeEndpoint(bX,b0);b1.previousConnection=null;D(a3[b1.scope],function(b3){return b3.id===b1.id});bs.anchorManager.connectionDetached({sourceId:b1.sourceId,targetId:b1.targetId,connection:b1});bz(b1)}}bW.repaint();bs.repaint(bW.elementId);bs.repaint(b1.targetId)}});var bO=function(b1){if(!ag[bL]){return}var bZ=bs.select({source:bL}).length;if(Q[bL]>=0&&bZ>=Q[bL]){if(bC){bC({element:bS,maxConnections:bE},b1)}return false}if(bG.filter){var bX=bG.filter(bJ.getOriginalEvent(b1),bS);if(bX===false){return}}var b5=aa({elId:bM});var b4=((b1.pageX||b1.page.x)-b5.left)/b5.width,b3=((b1.pageY||b1.page.y)-b5.top)/b5.height,b9=b4,b8=b3;if(bD.parent){var b2=bJ.getElementObject(bD.parent),b0=K(b2);b5=aa({elId:b0});b9=((b1.pageX||b1.page.x)-b5.left)/b5.width,b8=((b1.pageY||b1.page.y)-b5.top)/b5.height}var b7={};p.extend(b7,bD);b7.isSource=true;b7.anchor=[b4,b3,0,0];b7.parentAnchor=[b9,b8,0,0];b7.dragOptions=bU;if(bD.parent){var bY=b7.container||bs.Defaults.Container||p.Defaults.Container;if(bY){b7.container=bY}else{b7.container=p.CurrentLibrary.getParent(bD.parent)}}bW=bs.addEndpoint(bM,b7);bQ=true;bW.endpointWillMoveAfterConnection=bD.parent!=null;bW.endpointWillMoveTo=bD.parent?bJ.getElementObject(bD.parent):null;var b6=function(){if(bQ){bs.deleteEndpoint(bW)}};bs.registerListener(bW.canvas,"mouseup",b6);bs.registerListener(bS,"mouseup",b6);bJ.trigger(bW.canvas,"mousedown",b1)};bs.registerListener(bS,"mousedown",bO);M[bM]=bO};bF=aN(bF);var bI=bF.length&&bF.constructor!=String?bF:[bF];for(var bH=0;bH<bI.length;bH++){bB(F(bI[bH]))}return bs};this.unmakeSource=function(bC,bD){bC=p.CurrentLibrary.getElementObject(bC);var bE=K(bC),bB=M[bE];if(bB){bs.unregisterListener(_el,"mousedown",bB)}if(!bD){delete aD[bE];delete be[bE];delete ag[bE];delete M[bE];delete Q[bE]}return bs};this.unmakeEverySource=function(){for(var bB in ag){bs.unmakeSource(bB,true)}aD={};be={};ag={};M={}};this.unmakeEveryTarget=function(){for(var bB in an){bs.unmakeTarget(bB,true)}a4={};bm={};au={};an={};return bs};this.makeSources=function(bD,bE,bB){for(var bC=0;bC<bD.length;bC++){bs.makeSource(bD[bC],bE,bB)}return bs};var aR=function(bF,bE,bG,bB){var bC=bF=="source"?ag:an;if(C(bE)){bC[bE]=bB?!bC[bE]:bG}else{if(bE.length){bE=aN(bE);for(var bD=0;bD<bE.length;bD++){var bH=_el=p.CurrentLibrary.getElementObject(bE[bD]),bH=K(_el);bC[bH]=bB?!bC[bH]:bG}}}return bs};this.setSourceEnabled=function(bB,bC){return aR("source",bB,bC)};this.toggleSourceEnabled=function(bB){aR("source",bB,null,true);return bs.isSourceEnabled(bB)};this.isSource=function(bB){bB=p.CurrentLibrary.getElementObject(bB);return ag[K(bB)]!=null};this.isSourceEnabled=function(bB){bB=p.CurrentLibrary.getElementObject(bB);return ag[K(bB)]===true};this.setTargetEnabled=function(bB,bC){return aR("target",bB,bC)};this.toggleTargetEnabled=function(bB){return aR("target",bB,null,true);return bs.isTargetEnabled(bB)};this.isTarget=function(bB){bB=p.CurrentLibrary.getElementObject(bB);return an[K(bB)]!=null};this.isTargetEnabled=function(bB){bB=p.CurrentLibrary.getElementObject(bB);return an[K(bB)]===true};this.ready=function(bB){bs.bind("ready",bB)},this.repaint=function(bC){var bD=function(bE){bf(F(bE))};if(typeof bC=="object"){for(var bB=0;bB<bC.length;bB++){bD(bC[bB])}}else{bD(bC)}};this.repaintEverything=function(){for(var bB in aY){bf(F(bB),null,null)}};this.removeAllEndpoints=function(bD){var bB=d(bD,"id"),bE=aY[bB];if(bE){for(var bC=0;bC<bE.length;bC++){bs.deleteEndpoint(bE[bC])}}aY[bB]=[]};this.removeEveryEndpoint=this.deleteEveryEndpoint;this.removeEndpoint=function(bB,bC){bs.deleteEndpoint(bC)};var ak={},bj=function(){for(var bC in ak){for(var bB=0;bB<ak[bC].length;bB++){var bD=ak[bC][bB];p.CurrentLibrary.unbind(bD.el,bD.event,bD.listener)}}ak={}};this.registerListener=function(bC,bB,bD){p.CurrentLibrary.bind(bC,bB,bD);Z(ak,bB,{el:bC,event:bB,listener:bD})};this.unregisterListener=function(bC,bB,bD){p.CurrentLibrary.unbind(bC,bB,bD);D(ak,function(bE){return bE.type==bB&&bE.listener==bD})};this.reset=function(){bs.deleteEveryEndpoint();bs.unbind();a4={};aM={};bm={};au={};aD={};a8={};be={};Q={};bj();bs.anchorManager.reset();bs.dragManager.reset()};this.setDefaultScope=function(bB){U=bB};this.setDraggable=bp;this.setId=function(bF,bB,bH){var bI=bF.constructor==String?bF:bs.getId(bF),bE=bs.getConnections({source:bI,scope:"*"},true),bD=bs.getConnections({target:bI,scope:"*"},true);bB=""+bB;if(!bH){bF=p.CurrentLibrary.getElementObject(bI);p.CurrentLibrary.setAttribute(bF,"id",bB)}bF=p.CurrentLibrary.getElementObject(bB);aY[bB]=aY[bI]||[];for(var bC=0;bC<aY[bB].length;bC++){aY[bB][bC].elementId=bB;aY[bB][bC].element=bF;aY[bB][bC].anchor.elementId=bB}delete aY[bI];bs.anchorManager.changeId(bI,bB);var bG=function(bM,bJ,bL){for(var bK=0;bK<bM.length;bK++){bM[bK].endpoints[bJ].elementId=bB;bM[bK].endpoints[bJ].element=bF;bM[bK][bL+"Id"]=bB;bM[bK][bL]=bF}};bG(bE,0,"source");bG(bD,1,"target")};this.setIdChanged=function(bC,bB){bs.setId(bC,bB,true)};this.setDebugLog=function(bB){R=bB};this.setRepaintFunction=function(bB){aw=bB};var bb=false;this.setSuspendDrawing=function(bC,bB){bb=bC;if(bB){bs.repaintEverything()}};this.isSuspendDrawing=function(){return bb};this.CANVAS="canvas";this.SVG="svg";this.VML="vml";this.setRenderMode=function(bB){if(bB){bB=bB.toLowerCase()}else{return}if(bB!==p.CANVAS&&bB!==p.SVG&&bB!==p.VML){throw new Error("render mode must be one of jsPlumb.CANVAS, jsPlumb.SVG or jsPlumb.VML")}if(bB===p.SVG){if(e){ab=p.SVG}else{if(A){ab=p.CANVAS}else{if(b()){ab=p.VML}}}}else{if(bB===p.CANVAS&&A){ab=p.CANVAS}else{if(b()){ab=p.VML}}}return ab};this.getRenderMode=function(){return ab};this.show=function(bB,bC){a9(bB,"block",bC)};this.sizeCanvas=function(bD,bB,bF,bC,bE){if(bD){bD.style.height=bE+"px";bD.height=bE;bD.style.width=bC+"px";bD.width=bC;bD.style.left=bB+"px";bD.style.top=bF+"px"}};this.getTestHarness=function(){return{endpointsByElement:aY,endpointCount:function(bB){var bC=aY[bB];return bC?bC.length:0},connectionCount:function(bB){bB=bB||U;var bC=a3[bB];return bC?bC.length:0},getId:K,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}};this.toggle=aV;this.toggleVisible=aV;this.toggleDraggable=bn;this.unload=function(){};this.wrap=aq;this.addListener=this.bind;var bt=function(bG,bD){var bE=null,bB=bG;if(bD.tagName.toLowerCase()==="svg"&&bD.parentNode){bE=bD.parentNode}else{if(bD.offsetParent){bE=bD.offsetParent}}if(bE!=null){var bC=bE.tagName.toLowerCase()==="body"?{left:0,top:0}:t(bE),bF=bE.tagName.toLowerCase()==="body"?{left:0,top:0}:{left:bE.scrollLeft,top:bE.scrollTop};bB[0]=bG[0]-bC.left+bF.left;bB[1]=bG[1]-bC.top+bF.top}return bB};var ae=function(bF){var bD=this;this.x=bF.x||0;this.y=bF.y||0;this.elementId=bF.elementId;var bC=bF.orientation||[0,0];var bE=null,bB=null;this.offsets=bF.offsets||[0,0];bD.timestamp=null;this.compute=function(bK){var bJ=bK.xy,bG=bK.wh,bH=bK.element,bI=bK.timestamp;if(bI&&bI===bD.timestamp){return bB}bB=[bJ[0]+(bD.x*bG[0])+bD.offsets[0],bJ[1]+(bD.y*bG[1])+bD.offsets[1]];bB=bt(bB,bH.canvas);bD.timestamp=bI;return bB};this.getOrientation=function(bG){return bC};this.equals=function(bG){if(!bG){return false}var bH=bG.getOrientation();var bI=this.getOrientation();return this.x==bG.x&&this.y==bG.y&&this.offsets[0]==bG.offsets[0]&&this.offsets[1]==bG.offsets[1]&&bI[0]==bH[0]&&bI[1]==bH[1]};this.getCurrentLocation=function(){return bB}};var a6=function(bH){var bF=bH.reference,bG=bH.referenceCanvas,bD=a(F(bG)),bC=0,bI=0,bB=null,bE=null;this.x=0;this.y=0;this.isFloating=true;this.compute=function(bM){var bL=bM.xy,bK=bM.element,bJ=[bL[0]+(bD[0]/2),bL[1]+(bD[1]/2)];bJ=bt(bJ,bK.canvas);bE=bJ;return bJ};this.getOrientation=function(bK){if(bB){return bB}else{var bJ=bF.getOrientation(bK);return[Math.abs(bJ[0])*bC*-1,Math.abs(bJ[1])*bI*-1]}};this.over=function(bJ){bB=bJ.getOrientation()};this.out=function(){bB=null};this.getCurrentLocation=function(){return bE}};var av=function(bD,bC,bI){this.isSelective=true;this.isDynamic=true;var bL=[],bK=this,bJ=function(bM){return bM.constructor==ae?bM:bs.makeAnchor(bM,bI,bs)};for(var bH=0;bH<bD.length;bH++){bL[bH]=bJ(bD[bH])}this.addAnchor=function(bM){bL.push(bJ(bM))};this.getAnchors=function(){return bL};this.locked=false;var bE=bL.length>0?bL[0]:null,bG=bL.length>0?0:-1,bK=this,bF=function(bO,bM,bS,bR,bN){var bQ=bR[0]+(bO.x*bN[0]),bP=bR[1]+(bO.y*bN[1]);return Math.sqrt(Math.pow(bM-bQ,2)+Math.pow(bS-bP,2))},bB=bC||function(bW,bN,bO,bP,bM){var bR=bO[0]+(bP[0]/2),bQ=bO[1]+(bP[1]/2);var bT=-1,bV=Infinity;for(var bS=0;bS<bM.length;bS++){var bU=bF(bM[bS],bR,bQ,bW,bN);if(bU<bV){bT=bS+0;bV=bU}}return bM[bT]};this.compute=function(bQ){var bP=bQ.xy,bM=bQ.wh,bO=bQ.timestamp,bN=bQ.txy,bR=bQ.twh;if(bK.locked||bN==null||bR==null){return bE.compute(bQ)}else{bQ.timestamp=null}bE=bB(bP,bM,bN,bR,bL);bK.x=bE.x;bK.y=bE.y;return bE.compute(bQ)};this.getCurrentLocation=function(){return bE!=null?bE.getCurrentLocation():null};this.getOrientation=function(bM){return bE!=null?bE.getOrientation(bM):[0,0]};this.over=function(bM){if(bE!=null){bE.over(bM)}};this.out=function(){if(bE!=null){bE.out()}}};var bo={},am={},aO={},X={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},bq=function(bK,bL,bH,bE){if(bK===bL){return{orientation:X.IDENTITY,a:["top","top"]}}var bC=Math.atan2((bE.centery-bH.centery),(bE.centerx-bH.centerx)),bF=Math.atan2((bH.centery-bE.centery),(bH.centerx-bE.centerx)),bG=((bH.left<=bE.left&&bH.right>=bE.left)||(bH.left<=bE.right&&bH.right>=bE.right)||(bH.left<=bE.left&&bH.right>=bE.right)||(bE.left<=bH.left&&bE.right>=bH.right)),bM=((bH.top<=bE.top&&bH.bottom>=bE.top)||(bH.top<=bE.bottom&&bH.bottom>=bE.bottom)||(bH.top<=bE.top&&bH.bottom>=bE.bottom)||(bE.top<=bH.top&&bE.bottom>=bH.bottom));if(!(bG||bM)){var bJ=null,bD=false,bB=false,bI=null;if(bE.left>bH.left&&bE.top>bH.top){bJ=["right","top"]}else{if(bE.left>bH.left&&bH.top>bE.top){bJ=["top","left"]}else{if(bE.left<bH.left&&bE.top<bH.top){bJ=["top","right"]}else{if(bE.left<bH.left&&bE.top>bH.top){bJ=["left","top"]}}}}return{orientation:X.DIAGONAL,a:bJ,theta:bC,theta2:bF}}else{if(bG){return{orientation:X.HORIZONTAL,a:bH.top<bE.top?["bottom","top"]:["top","bottom"],theta:bC,theta2:bF}}else{return{orientation:X.VERTICAL,a:bH.left<bE.left?["right","left"]:["left","right"],theta:bC,theta2:bF}}}},a7=function(bP,bL,bJ,bK,bQ,bM,bD){var bR=[],bC=bL[bQ?0:1]/(bK.length+1);for(var bN=0;bN<bK.length;bN++){var bS=(bN+1)*bC,bB=bM*bL[bQ?1:0];if(bD){bS=bL[bQ?0:1]-bS}var bI=(bQ?bS:bB),bF=bJ[0]+bI,bH=bI/bL[0],bG=(bQ?bB:bS),bE=bJ[1]+bG,bO=bG/bL[1];bR.push([bF,bE,bH,bO,bK[bN][1],bK[bN][2]])}return bR},bd=function(bC,bB){return bC[0]>bB[0]?1:-1},ad=function(bB){return function(bD,bC){var bE=true;if(bB){if(bD[0][0]<bC[0][0]){bE=true}else{bE=bD[0][1]>bC[0][1]}}else{if(bD[0][0]>bC[0][0]){bE=true}else{bE=bD[0][1]>bC[0][1]}}return bE===false?-1:1}},P=function(bC,bB){var bE=bC[0][0]<0?-Math.PI-bC[0][0]:Math.PI-bC[0][0],bD=bB[0][0]<0?-Math.PI-bB[0][0]:Math.PI-bB[0][0];if(bE>bD){return 1}else{return bC[0][1]>bB[0][1]?1:-1}},a5={top:bd,right:ad(true),bottom:ad(true),left:P},at=function(bB,bC){return bB.sort(bC)},ap=function(bC,bB){var bE=ai[bC],bF=al[bC],bD=function(bM,bT,bI,bL,bR,bQ,bH){if(bL.length>0){var bP=at(bL,a5[bM]),bN=bM==="right"||bM==="top",bG=a7(bM,bT,bI,bP,bR,bQ,bN);var bU=function(bX,bW){var bV=bt([bW[0],bW[1]],bX.canvas);am[bX.id]=[bV[0],bV[1],bW[2],bW[3]];aO[bX.id]=bH};for(var bJ=0;bJ<bG.length;bJ++){var bO=bG[bJ][4],bS=bO.endpoints[0].elementId===bC,bK=bO.endpoints[1].elementId===bC;if(bS){bU(bO.endpoints[0],bG[bJ])}else{if(bK){bU(bO.endpoints[1],bG[bJ])}}}}};bD("bottom",bE,[bF.left,bF.top],bB.bottom,true,1,[0,1]);bD("top",bE,[bF.left,bF.top],bB.top,true,0,[0,-1]);bD("left",bE,[bF.left,bF.top],bB.left,false,0,[-1,0]);bD("right",bE,[bF.left,bF.top],bB.right,false,1,[1,0])},aI=function(){var bB={},bF={},bC=this,bE={};this.reset=function(){bB={};bF={};bE={}};this.newConnection=function(bJ){var bL=bJ.sourceId,bI=bJ.targetId,bG=bJ.endpoints,bK=true,bH=function(bM,bN,bP,bO,bQ){if((bL==bI)&&bP.isContinuous){p.CurrentLibrary.removeElement(bG[1].canvas);bK=false}Z(bF,bO,[bQ,bN,bP.constructor==av])};bH(0,bG[0],bG[0].anchor,bI,bJ);if(bK){bH(1,bG[1],bG[1].anchor,bL,bJ)}};this.connectionDetached=function(bG){var bH=bG.connection||bG;var bM=bH.sourceId,bN=bH.targetId,bQ=bH.endpoints,bL=function(bR,bS,bU,bT,bV){if(bU.constructor==a6){}else{D(bF[bT],function(bW){return bW[0].id==bV.id})}};bL(1,bQ[1],bQ[1].anchor,bM,bH);bL(0,bQ[0],bQ[0].anchor,bN,bH);var bI=bH.sourceId,bJ=bH.targetId,bP=bH.endpoints[0].id,bK=bH.endpoints[1].id,bO=function(bT,bR){if(bT){var bS=function(bU){return bU[4]==bR};D(bT.top,bS);D(bT.left,bS);D(bT.bottom,bS);D(bT.right,bS)}};bO(bE[bI],bP);bO(bE[bJ],bK);bC.redraw(bI);bC.redraw(bJ)};this.add=function(bH,bG){Z(bB,bG,bH)};this.changeId=function(bH,bG){bF[bG]=bF[bH];bB[bG]=bB[bH];delete bF[bH];delete bB[bH]};this.getConnectionsFor=function(bG){return bF[bG]||[]};this.getEndpointsFor=function(bG){return bB[bG]||[]};this.deleteEndpoint=function(bG){D(bB[bG.elementId],function(bH){return bH.id==bG.id})};this.clearFor=function(bG){delete bB[bG];bB[bG]=[]};var bD=function(b0,bN,bV,bK,bQ,bR,bT,bP,b2,bS,bJ,bZ){var bX=-1,bI=-1,bL=bK.endpoints[bT],bU=bL.id,bO=[1,0][bT],bG=[[bN,bV],bK,bQ,bR,bU],bH=b0[b2],b1=bL._continuousAnchorEdge?b0[bL._continuousAnchorEdge]:null;if(b1){var bY=i(b1,function(b3){return b3[4]==bU});if(bY!=-1){b1.splice(bY,1);for(var bW=0;bW<b1.length;bW++){u(bJ,b1[bW][1],function(b3){return b3.id==b1[bW][1].id});u(bZ,b1[bW][1].endpoints[bT],function(b3){return b3.id==b1[bW][1].endpoints[bT].id})}}}for(var bW=0;bW<bH.length;bW++){if(bT==1&&bH[bW][3]===bR&&bI==-1){bI=bW}u(bJ,bH[bW][1],function(b3){return b3.id==bH[bW][1].id});u(bZ,bH[bW][1].endpoints[bT],function(b3){return b3.id==bH[bW][1].endpoints[bT].id})}if(bX!=-1){bH[bX]=bG}else{var bM=bP?bI!=-1?bI:0:bH.length;bH.splice(bM,0,bG)}bL._continuousAnchorEdge=b2};this.redraw=function(bV,bX,bI,bL){if(!bb){var b6=bB[bV]||[],b5=bF[bV]||[],bH=[],b4=[],bJ=[];bI=bI||r();bL=bL||{left:0,top:0};if(bX){bX={left:bX.left+bL.left,top:bX.top+bL.top}}aa({elId:bV,offset:bX,recalc:false,timestamp:bI});var bQ=al[bV],bM=ai[bV],bS={};for(var b2=0;b2<b5.length;b2++){var bN=b5[b2][0],bP=bN.sourceId,bK=bN.targetId,bO=bN.endpoints[0].anchor.isContinuous,bU=bN.endpoints[1].anchor.isContinuous;if(bO||bU){var b3=bP+"_"+bK,b0=bK+"_"+bP,bZ=bS[b3],bT=bN.sourceId==bV?1:0;if(bO&&!bE[bP]){bE[bP]={top:[],right:[],bottom:[],left:[]}}if(bU&&!bE[bK]){bE[bK]={top:[],right:[],bottom:[],left:[]}}if(bV!=bK){aa({elId:bK,timestamp:bI})}if(bV!=bP){aa({elId:bP,timestamp:bI})}var bR=aS(bK),bG=aS(bP);if(bK==bP&&(bO||bU)){bD(bE[bP],-Math.PI/2,0,bN,false,bK,0,false,"top",bP,bH,b4)}else{if(!bZ){bZ=bq(bP,bK,bG.o,bR.o);bS[b3]=bZ}if(bO){bD(bE[bP],bZ.theta,0,bN,false,bK,0,false,bZ.a[0],bP,bH,b4)}if(bU){bD(bE[bK],bZ.theta2,-1,bN,true,bP,1,true,bZ.a[1],bK,bH,b4)}}if(bO){u(bJ,bP,function(b7){return b7===bP})}if(bU){u(bJ,bK,function(b7){return b7===bK})}u(bH,bN,function(b7){return b7.id==bN.id});if((bO&&bT==0)||(bU&&bT==1)){u(b4,bN.endpoints[bT],function(b7){return b7.id==bN.endpoints[bT].id})}}}for(var b2=0;b2<bJ.length;b2++){ap(bJ[b2],bE[bJ[b2]])}for(var b2=0;b2<b6.length;b2++){b6[b2].paint({timestamp:bI,offset:bQ,dimensions:bM})}for(var b2=0;b2<b4.length;b2++){b4[b2].paint({timestamp:bI,offset:bQ,dimensions:bM})}for(var b2=0;b2<b5.length;b2++){var bW=b5[b2][1];if(bW.anchor.constructor==av){bW.paint({elementWithPrecedence:bV});u(bH,b5[b2][0],function(b7){return b7.id==b5[b2][0].id});for(var b1=0;b1<bW.connections.length;b1++){if(bW.connections[b1]!==b5[b2][0]){u(bH,bW.connections[b1],function(b7){return b7.id==bW.connections[b1].id})}}}else{if(bW.anchor.constructor==ae){u(bH,b5[b2][0],function(b7){return b7.id==b5[b2][0].id})}}}var bY=bl[bV];if(bY){bY.paint({timestamp:bI,recalc:false,elId:bV})}for(var b2=0;b2<bH.length;b2++){bH[b2].paint({elId:bV,timestamp:bI,recalc:false})}}};this.rehomeEndpoint=function(bG,bK){var bH=bB[bG]||[],bI=bs.getId(bK);for(var bJ=0;bJ<bH.length;bJ++){bC.add(bH[bJ],bI)}bH.splice(0,bH.length)}};bs.anchorManager=new aI();bs.continuousAnchorFactory={get:function(bC){var bB=bo[bC.elementId];if(!bB){bB={type:"Continuous",compute:function(bD){return am[bD.element.id]||[0,0]},getCurrentLocation:function(bD){return am[bD.id]||[0,0]},getOrientation:function(bD){return aO[bD.id]||[0,0]},isDynamic:true,isContinuous:true};bo[bC.elementId]=bB}return bB}};var a0=function(){var bE={},bD=[],bC={},bB={};this.register=function(bH){var bG=p.CurrentLibrary;bH=bG.getElementObject(bH);var bJ=bs.getId(bH),bF=bG.getDOMElement(bH);if(!bE[bJ]){bE[bJ]=bH;bD.push(bH);bC[bJ]={}}var bI=function(bN){var bQ=bG.getElementObject(bN),bP=bG.getOffset(bQ);for(var bK=0;bK<bN.childNodes.length;bK++){if(bN.childNodes[bK].nodeType!=3){var bM=bG.getElementObject(bN.childNodes[bK]),bO=bs.getId(bM,null,true);if(bO&&bB[bO]&&bB[bO]>0){var bL=bG.getOffset(bM);bC[bJ][bO]={id:bO,offset:{left:bL.left-bP.left,top:bL.top-bP.top}}}}}};bI(bF)};this.endpointAdded=function(bH){var bL=p.CurrentLibrary,bO=document.body,bF=bs.getId(bH),bN=bL.getDOMElement(bH),bG=bN.parentNode,bJ=bG==bO;bB[bF]=bB[bF]?bB[bF]+1:1;while(bG!=bO){var bK=bs.getId(bG);if(bE[bK]){var bQ=-1,bM=bL.getElementObject(bG),bI=bL.getOffset(bM);if(bC[bK][bF]==null){var bP=p.CurrentLibrary.getOffset(bH);bC[bK][bF]={id:bF,offset:{left:bP.left-bI.left,top:bP.top-bI.top}}}break}bG=bG.parentNode}};this.endpointDeleted=function(bG){if(bB[bG.elementId]){bB[bG.elementId]--;if(bB[bG.elementId]<=0){for(var bF in bC){delete bC[bF][bG.elementId]}}}};this.getElementsForDraggable=function(bF){return bC[bF]};this.reset=function(){bE={};bD=[];bC={};bB={}}};bs.dragManager=new a0();var aB=function(bT){var bM=this,bD=true;bM.idPrefix="_jsplumb_c_";bM.defaultLabelLocation=0.5;bM.defaultOverlayKeys=["Overlays","ConnectionOverlays"];this.parent=bT.parent;z.apply(this,arguments);this.isVisible=function(){return bD};this.setVisible=function(bV){bD=bV;bM[bV?"showOverlays":"hideOverlays"]();if(bM.connector&&bM.connector.canvas){bM.connector.canvas.style.display=bV?"block":"none"}};this.source=F(bT.source);this.target=F(bT.target);if(bT.sourceEndpoint){this.source=bT.sourceEndpoint.endpointWillMoveTo||bT.sourceEndpoint.getElement()}if(bT.targetEndpoint){this.target=bT.targetEndpoint.getElement()}bM.previousConnection=bT.previousConnection;var bJ=bT.cost;bM.getCost=function(){return bJ};bM.setCost=function(bV){bJ=bV};var bH=bT.bidirectional===false?false:true;bM.isBidirectional=function(){return bH};this.sourceId=d(this.source,"id");this.targetId=d(this.target,"id");this.getAttachedElements=function(){return bM.endpoints};this.scope=bT.scope;this.endpoints=[];this.endpointStyles=[];var bS=function(bW,bV){if(bW){return bs.makeAnchor(bW,bV,bs)}},bQ=function(bV,b1,bW,bY,bZ,bX,b0){if(bV){bM.endpoints[b1]=bV;bV.addConnection(bM)}else{if(!bW.endpoints){bW.endpoints=[null,null]}var b7=bW.endpoints[b1]||bW.endpoint||bs.Defaults.Endpoints[b1]||p.Defaults.Endpoints[b1]||bs.Defaults.Endpoint||p.Defaults.Endpoint;if(!bW.endpointStyles){bW.endpointStyles=[null,null]}if(!bW.endpointHoverStyles){bW.endpointHoverStyles=[null,null]}var b5=bW.endpointStyles[b1]||bW.endpointStyle||bs.Defaults.EndpointStyles[b1]||p.Defaults.EndpointStyles[b1]||bs.Defaults.EndpointStyle||p.Defaults.EndpointStyle;if(b5.fillStyle==null&&bX!=null){b5.fillStyle=bX.strokeStyle}if(b5.outlineColor==null&&bX!=null){b5.outlineColor=bX.outlineColor}if(b5.outlineWidth==null&&bX!=null){b5.outlineWidth=bX.outlineWidth}var b4=bW.endpointHoverStyles[b1]||bW.endpointHoverStyle||bs.Defaults.EndpointHoverStyles[b1]||p.Defaults.EndpointHoverStyles[b1]||bs.Defaults.EndpointHoverStyle||p.Defaults.EndpointHoverStyle;if(b0!=null){if(b4==null){b4={}}if(b4.fillStyle==null){b4.fillStyle=b0.strokeStyle}}var b3=bW.anchors?bW.anchors[b1]:bW.anchor?bW.anchor:bS(bs.Defaults.Anchors[b1],bZ)||bS(p.Defaults.Anchors[b1],bZ)||bS(bs.Defaults.Anchor,bZ)||bS(p.Defaults.Anchor,bZ),b6=bW.uuids?bW.uuids[b1]:null,b2=aJ({paintStyle:b5,hoverPaintStyle:b4,endpoint:b7,connections:[bM],uuid:b6,anchor:b3,source:bY,scope:bW.scope,container:bW.container,reattach:bW.reattach,detachable:bW.detachable});bM.endpoints[b1]=b2;if(bW.drawEndpoints===false){b2.setVisible(false,true,true)}return b2}};var bO=bQ(bT.sourceEndpoint,0,bT,bM.source,bM.sourceId,bT.paintStyle,bT.hoverPaintStyle);if(bO){Z(aY,this.sourceId,bO)}var bE=((bM.sourceId==bM.targetId)&&bT.targetEndpoint==null)?bO:bT.targetEndpoint,bN=bQ(bE,1,bT,bM.target,bM.targetId,bT.paintStyle,bT.hoverPaintStyle);if(bN){Z(aY,this.targetId,bN)}if(!this.scope){this.scope=this.endpoints[0].scope}if(bT.deleteEndpointsOnDetach){bM.endpointsToDeleteOnDetach=[bO,bN]}var bC=bs.Defaults.ConnectionsDetachable;if(bT.detachable===false){bC=false}if(bM.endpoints[0].connectionsDetachable===false){bC=false}if(bM.endpoints[1].connectionsDetachable===false){bC=false}if(bJ==null){bJ=bM.endpoints[0].getConnectionCost()}if(bT.bidirectional==null){bH=bM.endpoints[0].areConnectionsBidirectional()}this.isDetachable=function(){return bC===true};this.setDetachable=function(bV){bC=bV===true};var bU=p.extend({},this.endpoints[0].getParameters());p.extend(bU,this.endpoints[1].getParameters());p.extend(bU,bM.getParameters());bM.setParameters(bU);var bK=bM.setHover;bM.setHover=function(bV){bM.connector.setHover.apply(bM.connector,arguments);bK.apply(bM,arguments)};var bR=function(bV){if(x==null){bM.setHover(bV,false)}};this.setConnector=function(bV,bW){if(bM.connector!=null){a2(bM.connector.getDisplayElements(),bM.parent)}var bX={_jsPlumb:bM._jsPlumb,parent:bT.parent,cssClass:bT.cssClass,container:bT.container,tooltip:bM.tooltip};if(C(bV)){this.connector=new p.Connectors[ab][bV](bX)}else{if(n(bV)){this.connector=new p.Connectors[ab][bV[0]](p.extend(bV[1],bX))}}bM.canvas=bM.connector.canvas;G(bM.connector,bM,bR);if(!bW){bM.repaint()}};bM.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||bT.connector||bs.Defaults.Connector||p.Defaults.Connector,true);this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||bT.paintStyle||bs.Defaults.PaintStyle||p.Defaults.PaintStyle,true);this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||bT.hoverPaintStyle||bs.Defaults.HoverPaintStyle||p.Defaults.HoverPaintStyle,true);this.paintStyleInUse=this.getPaintStyle();this.moveParent=function(bY){var bX=p.CurrentLibrary,bW=bX.getParent(bM.connector.canvas);if(bM.connector.bgCanvas){bX.removeElement(bM.connector.bgCanvas,bW);bX.appendElement(bM.connector.bgCanvas,bY)}bX.removeElement(bM.connector.canvas,bW);bX.appendElement(bM.connector.canvas,bY);for(var bV=0;bV<bM.overlays.length;bV++){if(bM.overlays[bV].isAppendedAtTopLevel){bX.removeElement(bM.overlays[bV].canvas,bW);bX.appendElement(bM.overlays[bV].canvas,bY);if(bM.overlays[bV].reattachListeners){bM.overlays[bV].reattachListeners(bM.connector)}}}if(bM.connector.reattachListeners){bM.connector.reattachListeners()}};aa({elId:this.sourceId});aa({elId:this.targetId});var bG=al[this.sourceId],bF=ai[this.sourceId],bB=al[this.targetId],bI=ai[this.targetId],bL=r(),bP=this.endpoints[0].anchor.compute({xy:[bG.left,bG.top],wh:bF,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[bB.left,bB.top],twh:bI,tElement:this.endpoints[1],timestamp:bL});this.endpoints[0].paint({anchorLoc:bP,timestamp:bL});bP=this.endpoints[1].anchor.compute({xy:[bB.left,bB.top],wh:bI,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[bG.left,bG.top],twh:bF,tElement:this.endpoints[0],timestamp:bL});this.endpoints[1].paint({anchorLoc:bP,timestamp:bL});this.paint=function(cc){cc=cc||{};var b3=cc.elId,b4=cc.ui,b1=cc.recalc,bW=cc.timestamp,b5=false,cb=b5?this.sourceId:this.targetId,b0=b5?this.targetId:this.sourceId,bX=b5?0:1,cd=b5?1:0;var ce=aa({elId:b3,offset:b4,recalc:b1,timestamp:bW}),b2=aa({elId:cb,timestamp:bW});var b7=this.endpoints[cd],bV=this.endpoints[bX],bZ=b7.anchor.getCurrentLocation(b7),ca=bV.anchor.getCurrentLocation(bV);var bY=0;for(var b9=0;b9<bM.overlays.length;b9++){var b6=bM.overlays[b9];if(b6.isVisible()){bY=Math.max(bY,b6.computeMaxSize(bM.connector))}}var b8=this.connector.compute(bZ,ca,this.endpoints[cd],this.endpoints[bX],this.endpoints[cd].anchor,this.endpoints[bX].anchor,bM.paintStyleInUse.lineWidth,bY,ce,b2);bM.connector.paint(b8,bM.paintStyleInUse);for(var b9=0;b9<bM.overlays.length;b9++){var b6=bM.overlays[b9];if(b6.isVisible){bM.overlayPlacements[b9]=b6.draw(bM.connector,bM.paintStyleInUse,b8)}}};this.repaint=function(bW){bW=bW||{};var bV=!(bW.recalc===false);this.paint({elId:this.sourceId,recalc:bV,timestamp:bW.timestamp})}};var bi=function(bC){var bB=false;return{drag:function(){if(bB){bB=false;return true}var bD=p.CurrentLibrary.getUIPosition(arguments),bE=bC.element;if(bE){p.CurrentLibrary.setOffset(bE,bD);bf(F(bE),bD)}},stopDrag:function(){bB=true}}};var ax=function(bF,bE,bG,bD,bB){var bC=new a6({reference:bE,referenceCanvas:bD});return aJ({paintStyle:bF,endpoint:bG,anchor:bC,source:bB,scope:"__floating"})};var V=function(bD,bB){var bF=document.createElement("div");bF.style.position="absolute";var bC=F(bF);a1(bF,bB);var bE=K(bC);aa({elId:bE});bD.id=bE;bD.element=bC};var aj=function(b6){var bU=this;bU.idPrefix="_jsplumb_e_";bU.defaultLabelLocation=[0.5,0.5];bU.defaultOverlayKeys=["Overlays","EndpointOverlays"];this.parent=b6.parent;z.apply(this,arguments);b6=b6||{};var bG=true,bE=!(b6.enabled===false);this.isVisible=function(){return bG};this.setVisible=function(b9,cc,b8){bG=b9;if(bU.canvas){bU.canvas.style.display=b9?"block":"none"}bU[b9?"showOverlays":"hideOverlays"]();if(!cc){for(var cb=0;cb<bU.connections.length;cb++){bU.connections[cb].setVisible(b9);if(!b8){var ca=bU===bU.connections[cb].endpoints[0]?1:0;if(bU.connections[cb].endpoints[ca].connections.length==1){bU.connections[cb].endpoints[ca].setVisible(b9,true,true)}}}}};this.isEnabled=function(){return bE};this.setEnabled=function(b8){bE=b8};var bT=b6.source,bN=b6.uuid,b4=null,bI=null;if(bN){aZ[bN]=bU}var bL=d(bT,"id");this.elementId=bL;this.element=bT;var bD=b6.connectionCost;this.getConnectionCost=function(){return bD};this.setConnectionCost=function(b8){bD=b8};var b3=b6.connectionsBidirectional===false?false:true;this.areConnectionsBidirectional=function(){return b3};this.setConnectionsBidirectional=function(b8){b3=b8};bU.anchor=b6.anchor?bs.makeAnchor(b6.anchor,bL,bs):b6.anchors?bs.makeAnchor(b6.anchors,bL,bs):bs.makeAnchor("TopCenter",bL,bs);if(!b6._transient){bs.anchorManager.add(bU,bL)}var bR=null,bW=null;this.setEndpoint=function(b8){var b9={_jsPlumb:bU._jsPlumb,parent:b6.parent,container:b6.container,tooltip:b6.tooltip,connectorTooltip:b6.connectorTooltip,endpoint:bU};if(C(b8)){bR=new p.Endpoints[ab][b8](b9)}else{if(n(b8)){b9=p.extend(b8[1],b9);bR=new p.Endpoints[ab][b8[0]](b9)}else{bR=b8.clone()}}var ca=p.extend({},b9);bR.clone=function(){var cb=new Object();bR.constructor.apply(cb,[ca]);return cb};bU.endpoint=bR;bU.type=bU.endpoint.type};this.setEndpoint(b6.endpoint||bs.Defaults.Endpoint||p.Defaults.Endpoint||"Dot");bW=bR;var bS=bU.setHover;bU.setHover=function(){bU.endpoint.setHover.apply(bU.endpoint,arguments);bS.apply(bU,arguments)};var b7=function(b8){if(bU.connections.length>0){bU.connections[0].setHover(b8,false)}else{bU.setHover(b8)}};G(bU.endpoint,bU,b7);this.setPaintStyle(b6.paintStyle||b6.style||bs.Defaults.EndpointStyle||p.Defaults.EndpointStyle,true);this.setHoverPaintStyle(b6.hoverPaintStyle||bs.Defaults.EndpointHoverStyle||p.Defaults.EndpointHoverStyle,true);this.paintStyleInUse=this.getPaintStyle();var bP=this.getPaintStyle();this.connectorStyle=b6.connectorStyle;this.connectorHoverStyle=b6.connectorHoverStyle;this.connectorOverlays=b6.connectorOverlays;this.connector=b6.connector;this.connectorTooltip=b6.connectorTooltip;this.isSource=b6.isSource||false;this.isTarget=b6.isTarget||false;var b0=b6.maxConnections||bs.Defaults.MaxConnections;this.getAttachedElements=function(){return bU.connections};this.canvas=this.endpoint.canvas;this.connections=b6.connections||[];this.scope=b6.scope||U;this.timestamp=null;bU.isReattach=b6.reattach||false;bU.connectionsDetachable=bs.Defaults.ConnectionsDetachable;if(b6.connectionsDetachable===false||b6.detachable===false){bU.connectionsDetachable=false}var bO=b6.dragAllowedWhenFull||true;if(b6.onMaxConnections){bU.bind("maxConnections",b6.onMaxConnections)}this.computeAnchor=function(b8){return bU.anchor.compute(b8)};this.addConnection=function(b8){bU.connections.push(b8)};this.detach=function(b9,ce,ca,ch,b8){var cg=i(bU.connections,function(cj){return cj.id==b9.id}),cf=false;ch=(ch!==false);if(cg>=0){if(ca||b9._forceDetach||b9.isDetachable()||b9.isDetachAllowed(b9)){var ci=b9.endpoints[0]==bU?b9.endpoints[1]:b9.endpoints[0];if(ca||b9._forceDetach||(bU.isDetachAllowed(b9))){bU.connections.splice(cg,1);if(!ce){ci.detach(b9,true,ca);if(b9.endpointsToDeleteOnDetach){for(var cd=0;cd<b9.endpointsToDeleteOnDetach.length;cd++){var cb=b9.endpointsToDeleteOnDetach[cd];if(cb&&cb.connections.length==0){bs.deleteEndpoint(cb)}}}}a2(b9.connector.getDisplayElements(),b9.parent);D(a3[b9.scope],function(cj){return cj.id==b9.id});cf=true;var cc=(!ce&&ch);bc(b9,cc,b8)}}}return cf};this.detachAll=function(b9,b8){while(bU.connections.length>0){bU.detach(bU.connections[0],false,true,b9,b8)}};this.detachFrom=function(cb,ca,b8){var cc=[];for(var b9=0;b9<bU.connections.length;b9++){if(bU.connections[b9].endpoints[1]==cb||bU.connections[b9].endpoints[0]==cb){cc.push(bU.connections[b9])}}for(var b9=0;b9<cc.length;b9++){if(bU.detach(cc[b9],false,true,ca,b8)){cc[b9].setHover(false,false)}}};this.detachFromConnection=function(b9){var b8=i(bU.connections,function(ca){return ca.id==b9.id});if(b8>=0){bU.connections.splice(b8,1)}};this.getElement=function(){return bT};this.setElement=function(cb,b8){var cd=K(cb);D(aY[bU.elementId],function(ce){return ce.id==bU.id});bT=F(cb);bL=K(bT);bU.elementId=bL;var cc=aA({source:cd,container:b8}),ca=bF.getParent(bU.canvas);bF.removeElement(bU.canvas,ca);bF.appendElement(bU.canvas,cc);for(var b9=0;b9<bU.connections.length;b9++){bU.connections[b9].moveParent(cc);bU.connections[b9].sourceId=bL;bU.connections[b9].source=bT}Z(aY,cd,bU)};this.getUuid=function(){return bN};this.makeInPlaceCopy=function(){var ca=bU.anchor.getCurrentLocation(bU),b9=bU.anchor.getOrientation(bU),b8={compute:function(){return[ca[0],ca[1]]},getCurrentLocation:function(){return[ca[0],ca[1]]},getOrientation:function(){return b9}};return aJ({anchor:b8,source:bT,paintStyle:this.getPaintStyle(),endpoint:bR,_transient:true,scope:bU.scope})};this.isConnectedTo=function(ca){var b9=false;if(ca){for(var b8=0;b8<bU.connections.length;b8++){if(bU.connections[b8].endpoints[1]==ca){b9=true;break}}}return b9};this.isFloating=function(){return b4!=null};this.connectorSelector=function(){var b8=bU.connections[0];if(bU.isTarget&&b8){return b8}else{return(bU.connections.length<b0)||b0==-1?null:b8}};this.isFull=function(){return !(bU.isFloating()||b0<1||bU.connections.length<b0)};this.setDragAllowedWhenFull=function(b8){bO=b8};this.setStyle=bU.setPaintStyle;this.equals=function(b8){return this.anchor.equals(b8.anchor)};var bQ=function(b9){var b8=0;if(b9!=null){for(var ca=0;ca<bU.connections.length;ca++){if(bU.connections[ca].sourceId==b9||bU.connections[ca].targetId==b9){b8=ca;break}}}return bU.connections[b8]};this.paint=function(cb){cb=cb||{};var ch=cb.timestamp,cg=!(cb.recalc===false);if(!ch||bU.timestamp!==ch){aa({elId:bL,timestamp:ch,recalc:cg});var cn=cb.offset||al[bL];if(cn){var ce=cb.anchorPoint,cc=cb.connectorPaintStyle;if(ce==null){var b8=cb.dimensions||ai[bL];if(cn==null||b8==null){aa({elId:bL,timestamp:ch});cn=al[bL];b8=ai[bL]}var ca={xy:[cn.left,cn.top],wh:b8,element:bU,timestamp:ch};if(cg&&bU.anchor.isDynamic&&bU.connections.length>0){var ck=bQ(cb.elementWithPrecedence),cm=ck.endpoints[0]==bU?1:0,cd=cm==0?ck.sourceId:ck.targetId,cj=al[cd],cl=ai[cd];ca.txy=[cj.left,cj.top];ca.twh=cl;ca.tElement=ck.endpoints[cm]}ce=bU.anchor.compute(ca)}var ci=bR.compute(ce,bU.anchor.getOrientation(bU),bU.paintStyleInUse,cc||bU.paintStyleInUse);bR.paint(ci,bU.paintStyleInUse,bU.anchor);bU.timestamp=ch;for(var cf=0;cf<bU.overlays.length;cf++){var b9=bU.overlays[cf];if(b9.isVisible){bU.overlayPlacements[cf]=b9.draw(bU.endpoint,bU.paintStyleInUse,ci)}}}}};this.repaint=this.paint;this.removeConnection=this.detach;if(p.CurrentLibrary.isDragSupported(bT)){var bZ={id:null,element:null},bY=null,bC=false,bH=null,bB=bi(bZ);var bJ=function(){bY=bU.connectorSelector();var b8=true;if(!bU.isEnabled()){b8=false}if(bY==null&&!b6.isSource){b8=false}if(b6.isSource&&bU.isFull()&&!bO){b8=false}if(bY!=null&&!bY.isDetachable()){b8=false}if(b8===false){if(p.CurrentLibrary.stopDrag){p.CurrentLibrary.stopDrag()}bB.stopDrag();return false}if(bY&&!bU.isFull()&&b6.isSource){bY=null}aa({elId:bL});bI=bU.makeInPlaceCopy();bI.paint();V(bZ,bU.parent);var ce=F(bI.canvas),cc=p.CurrentLibrary.getOffset(ce),b9=bt([cc.left,cc.top],bI.canvas);p.CurrentLibrary.setOffset(bZ.element,{left:b9[0],top:b9[1]});if(bU.parentAnchor){bU.anchor=bs.makeAnchor(bU.parentAnchor,bU.elementId,bs)}f(F(bU.canvas),"dragId",bZ.id);f(F(bU.canvas),"elId",bL);if(b6.proxy){bU.setPaintStyle(b6.proxy.paintStyle)}b4=ax(bU.getPaintStyle(),bU.anchor,bR,bU.canvas,bZ.element);if(bY==null){bU.anchor.locked=true;bU.setHover(false,false);bY=ah({sourceEndpoint:bU,targetEndpoint:b4,source:bU.endpointWillMoveTo||F(bT),target:bZ.element,anchors:[bU.anchor,b4.anchor],paintStyle:b6.connectorStyle,hoverPaintStyle:b6.connectorHoverStyle,connector:b6.connector,overlays:b6.connectorOverlays})}else{bC=true;bY.connector.setHover(false,false);bK(F(bI.canvas),false,true);var cb=bY.endpoints[0].id==bU.id?0:1;bY.floatingAnchorIndex=cb;bU.detachFromConnection(bY);var cf=F(bU.canvas),cd=p.CurrentLibrary.getDragScope(cf);f(cf,"originalScope",cd);var ca=p.CurrentLibrary.getDropScope(cf);p.CurrentLibrary.setDragScope(cf,ca);if(cb==0){bH=[bY.source,bY.sourceId,b2,cd];bY.source=bZ.element;bY.sourceId=bZ.id}else{bH=[bY.target,bY.targetId,b2,cd];bY.target=bZ.element;bY.targetId=bZ.id}bY.endpoints[cb==0?1:0].anchor.locked=true;bY.suspendedEndpoint=bY.endpoints[cb];bY.suspendedEndpoint.setHover(false);bY.endpoints[cb]=b4;ba(bY)}bl[bZ.id]=bY;b4.addConnection(bY);Z(aY,bZ.id,b4);bs.currentlyDragging=true};var bF=p.CurrentLibrary,b1=b6.dragOptions||{},bV=p.extend({},bF.defaultDragOptions),bX=bF.dragEvents.start,b5=bF.dragEvents.stop,bM=bF.dragEvents.drag;b1=p.extend(bV,b1);b1.scope=b1.scope||bU.scope;b1[bX]=aq(b1[bX],bJ);b1[bM]=aq(b1[bM],bB.drag);b1[b5]=aq(b1[b5],function(){var b9=bF.getDropEvent(arguments);bs.currentlyDragging=false;D(aY[bZ.id],function(ca){return ca.id==b4.id});a2([bZ.element[0],b4.canvas],bT);ay(bI.canvas,bT);bs.anchorManager.clearFor(bZ.id);var b8=bY.floatingAnchorIndex==null?1:bY.floatingAnchorIndex;bY.endpoints[b8==0?1:0].anchor.locked=false;bU.setPaintStyle(bP);if(bY.endpoints[b8]==b4){if(bC&&bY.suspendedEndpoint){if(b8==0){bY.source=bH[0];bY.sourceId=bH[1]}else{bY.target=bH[0];bY.targetId=bH[1]}p.CurrentLibrary.setDragScope(bH[2],bH[3]);bY.endpoints[b8]=bY.suspendedEndpoint;if(bU.isReattach||bY._forceDetach||!bY.endpoints[b8==0?1:0].detach(bY,false,false,true,b9)){bY.setHover(false);bY.floatingAnchorIndex=null;bY.suspendedEndpoint.addConnection(bY);bs.repaint(bH[1])}bY._forceDetach=null}else{a2(bY.connector.getDisplayElements(),bU.parent);bU.detachFromConnection(bY)}}bU.anchor.locked=false;bU.paint({recalc:false});bY.setHover(false,false);aW(bY);bY=null;bI=null;delete aY[b4.elementId];b4.anchor=null;b4=null;bs.currentlyDragging=false});var b2=F(bU.canvas);p.CurrentLibrary.initDraggable(b2,b1,true)}var bK=function(ca,cf,cd,cg){if((b6.isTarget||cf)&&p.CurrentLibrary.isDropSupported(bT)){var cb=b6.dropOptions||bs.Defaults.DropOptions||p.Defaults.DropOptions;cb=p.extend({},cb);cb.scope=cb.scope||bU.scope;var b9=p.CurrentLibrary.dragEvents.drop,ce=p.CurrentLibrary.dragEvents.over,b8=p.CurrentLibrary.dragEvents.out,cc=function(){var ch=p.CurrentLibrary.getDropEvent(arguments),cu=F(p.CurrentLibrary.getDragObject(arguments)),ci=d(cu,"dragId"),cl=d(cu,"elId"),ct=d(cu,"originalScope"),co=bl[ci];if(co!=null){var cq=co.floatingAnchorIndex==null?1:co.floatingAnchorIndex,cr=cq==0?1:0;if(ct){p.CurrentLibrary.setDragScope(cu,ct)}var cs=cg!=null?cg.isEnabled():true;if(bU.isFull()){bU.fire("maxConnections",{endpoint:bU,connection:co,maxConnections:b0},ch)}if(!bU.isFull()&&!(cq==0&&!bU.isSource)&&!(cq==1&&!bU.isTarget)&&cs){var cm=true;if(co.suspendedEndpoint&&co.suspendedEndpoint.id!=bU.id){if(cq==0){co.source=co.suspendedEndpoint.element;co.sourceId=co.suspendedEndpoint.elementId}else{co.target=co.suspendedEndpoint.element;co.targetId=co.suspendedEndpoint.elementId}if(!co.isDetachAllowed(co)||!co.endpoints[cq].isDetachAllowed(co)||!co.suspendedEndpoint.isDetachAllowed(co)||!bs.checkCondition("beforeDetach",co)){cm=false}}if(cq==0){co.source=bU.element;co.sourceId=bU.elementId}else{co.target=bU.element;co.targetId=bU.elementId}cm=cm&&bU.isDropAllowed(co.sourceId,co.targetId,co.scope,co,bU);if(cm){co.endpoints[cq].detachFromConnection(co);if(co.suspendedEndpoint){co.suspendedEndpoint.detachFromConnection(co)}co.endpoints[cq]=bU;bU.addConnection(co);var ck=bU.getParameters();for(var cp in ck){co.setParameter(cp,ck[cp])}if(!co.suspendedEndpoint){if(ck.draggable){p.CurrentLibrary.initDraggable(bU.element,b1,true)}}else{var cn=co.suspendedEndpoint.getElement(),cj=co.suspendedEndpoint.elementId;bc({source:cq==0?cn:co.source,target:cq==1?cn:co.target,sourceId:cq==0?cj:co.sourceId,targetId:cq==1?cj:co.targetId,sourceEndpoint:cq==0?co.suspendedEndpoint:co.endpoints[0],targetEndpoint:cq==1?co.suspendedEndpoint:co.endpoints[1],connection:co},true,ch)}bz(co,null,ch)}else{if(co.suspendedEndpoint){co.endpoints[cq]=co.suspendedEndpoint;co.setHover(false);co._forceDetach=true;if(cq==0){co.source=co.suspendedEndpoint.element;co.sourceId=co.suspendedEndpoint.elementId}else{co.target=co.suspendedEndpoint.element;co.targetId=co.suspendedEndpoint.elementId}co.suspendedEndpoint.addConnection(co);co.endpoints[0].repaint();co.repaint();bs.repaint(co.source.elementId);co._forceDetach=false}}co.floatingAnchorIndex=null}bs.currentlyDragging=false;delete bl[ci]}};cb[b9]=aq(cb[b9],cc);cb[ce]=aq(cb[ce],function(){if(bU.isTarget){var ci=p.CurrentLibrary.getDragObject(arguments),ck=d(F(ci),"dragId"),cj=bl[ck];if(cj!=null){var ch=cj.floatingAnchorIndex==null?1:cj.floatingAnchorIndex;cj.endpoints[ch].anchor.over(bU.anchor)}}});cb[b8]=aq(cb[b8],function(){if(bU.isTarget){var ci=p.CurrentLibrary.getDragObject(arguments),ck=d(F(ci),"dragId"),cj=bl[ck];if(cj!=null){var ch=cj.floatingAnchorIndex==null?1:cj.floatingAnchorIndex;cj.endpoints[ch].anchor.out()}}});p.CurrentLibrary.initDroppable(ca,cb,true,cd)}};bK(F(bU.canvas),true,!(b6._transient||bU.anchor.isFloating),bU);return bU}};var p=window.jsPlumb=new y();p.getInstance=function(L){var K=new y(L);K.init();return K};var s=function(K,P,M,L,O,N){return function(R){R=R||{};var Q=R.jsPlumbInstance.makeAnchor([K,P,M,L,0,0],R.elementId,R.jsPlumbInstance);Q.type=O;if(N){N(Q,R)}return Q}};p.Anchors.TopCenter=s(0.5,0,0,-1,"TopCenter");p.Anchors.BottomCenter=s(0.5,1,0,1,"BottomCenter");p.Anchors.LeftMiddle=s(0,0.5,-1,0,"LeftMiddle");p.Anchors.RightMiddle=s(1,0.5,1,0,"RightMiddle");p.Anchors.Center=s(0.5,0.5,0,0,"Center");p.Anchors.TopRight=s(1,0,0,-1,"TopRight");p.Anchors.BottomRight=s(1,1,0,1,"BottomRight");p.Anchors.TopLeft=s(0,0,0,-1,"TopLeft");p.Anchors.BottomLeft=s(0,1,0,1,"BottomLeft");p.Defaults.DynamicAnchors=function(K){return K.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],K.elementId,K.jsPlumbInstance)};p.Anchors.AutoDefault=function(L){var K=L.jsPlumbInstance.makeDynamicAnchor(p.Defaults.DynamicAnchors(L));K.type="AutoDefault";return K};p.Anchors.Assign=s(0,0,0,0,"Assign",function(L,M){var K=M.position||"Fixed";L.positionFinder=K.constructor==String?M.jsPlumbInstance.AnchorPositionFinders[K]:K;L.constructorParams=M});p.Anchors.Continuous=function(K){return K.jsPlumbInstance.continuousAnchorFactory.get(K)};p.AnchorPositionFinders={Fixed:function(N,K,M,L){return[(N.left-K.left)/M[0],(N.top-K.top)/M[1]]},Grid:function(K,T,O,L){var S=K.left-T.left,R=K.top-T.top,Q=O[0]/(L.grid[0]),P=O[1]/(L.grid[1]),N=Math.floor(S/Q),M=Math.floor(R/P);return[((N*Q)+(Q/2))/O[0],((M*P)+(P/2))/O[1]]}}})();(function(){jsPlumb.DOMElementComponent=function(c){jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(d){}};jsPlumb.Connectors.Straight=function(){this.type="Straight";var r=this,i=null,e,k,p,n,l,f,q,h,g,d,c,o,m;this.compute=function(A,J,s,z,F,t,D,v){var I=Math.abs(A[0]-J[0]),C=Math.abs(A[1]-J[1]),B=0.45*I,u=0.45*C;I*=1.9;C*=1.9;var G=Math.min(A[0],J[0])-B;var E=Math.min(A[1],J[1])-u;var H=Math.max(2*D,v);if(I<H){I=H;G=A[0]+((J[0]-A[0])/2)-(H/2);B=(I-Math.abs(A[0]-J[0]))/2}if(C<H){C=H;E=A[1]+((J[1]-A[1])/2)-(H/2);u=(C-Math.abs(A[1]-J[1]))/2}h=A[0]<J[0]?B:I-B;g=A[1]<J[1]?u:C-u;d=A[0]<J[0]?I-B:B;c=A[1]<J[1]?C-u:u;i=[G,E,I,C,h,g,d,c];n=d-h,l=c-g;e=jsPlumbUtil.gradient({x:h,y:g},{x:d,y:c}),k=-1/e;p=-1*((e*h)-g);f=Math.atan(e);q=Math.atan(k);m=Math.sqrt((n*n)+(l*l));return i};this.pointOnPath=function(t,u){if(t==0&&!u){return{x:h,y:g}}else{if(t==1&&!u){return{x:d,y:c}}else{var s=u?t>0?t:m+t:t*m;return jsPlumbUtil.pointOnLine({x:h,y:g},{x:d,y:c},s)}}};this.gradientAtPoint=function(s){return e};this.pointAlongPathFrom=function(s,w,v){var u=r.pointOnPath(s,v),t=s==1?{x:h+((d-h)*10),y:g+((g-c)*10)}:{x:d,y:c};return jsPlumbUtil.pointOnLine(u,t,w)}};jsPlumb.Connectors.Bezier=function(v){var p=this;v=v||{};this.majorAnchor=v.curviness||150;this.minorAnchor=10;var t=null;this.type="Bezier";this._findControlPoint=function(H,w,C,x,A,F,y){var E=F.getOrientation(x),G=y.getOrientation(A),B=E[0]!=G[0]||E[1]==G[1],z=[],I=p.majorAnchor,D=p.minorAnchor;if(!B){if(E[0]==0){z.push(w[0]<C[0]?H[0]+D:H[0]-D)}else{z.push(H[0]-(I*E[0]))}if(E[1]==0){z.push(w[1]<C[1]?H[1]+D:H[1]-D)}else{z.push(H[1]+(I*G[1]))}}else{if(G[0]==0){z.push(C[0]<w[0]?H[0]+D:H[0]-D)}else{z.push(H[0]+(I*G[0]))}if(G[1]==0){z.push(C[1]<w[1]?H[1]+D:H[1]-D)}else{z.push(H[1]+(I*E[1]))}}return z};var q,l,f,o,n,f,e,s,r,u,d,h,g,k,i;this.compute=function(S,z,M,A,Q,x,w,L){w=w||0;u=Math.abs(S[0]-z[0])+w;d=Math.abs(S[1]-z[1])+w;s=Math.min(S[0],z[0])-(w/2);r=Math.min(S[1],z[1])-(w/2);f=S[0]<z[0]?u-(w/2):(w/2);e=S[1]<z[1]?d-(w/2):(w/2);o=S[0]<z[0]?(w/2):u-(w/2);n=S[1]<z[1]?(w/2):d-(w/2);q=p._findControlPoint([f,e],S,z,M,A,Q,x);l=p._findControlPoint([o,n],z,S,A,M,x,Q);var K=Math.min(f,o),J=Math.min(q[0],l[0]),F=Math.min(K,J),R=Math.max(f,o),O=Math.max(q[0],l[0]),C=Math.max(R,O);if(C>u){u=C}if(F<0){s+=F;var H=Math.abs(F);u+=H;q[0]+=H;f+=H;o+=H;l[0]+=H}var P=Math.min(e,n),N=Math.min(q[1],l[1]),B=Math.min(P,N),G=Math.max(e,n),E=Math.max(q[1],l[1]),y=Math.max(G,E);if(y>d){d=y}if(B<0){r+=B;var D=Math.abs(B);d+=D;q[1]+=D;e+=D;n+=D;l[1]+=D}if(L&&u<L){var I=(L-u)/2;u=L;s-=I;f=f+I;o=o+I;q[0]=q[0]+I;l[0]=l[0]+I}if(L&&d<L){var I=(L-d)/2;d=L;r-=I;e=e+I;n=n+I;q[1]=q[1]+I;l[1]=l[1]+I}t=[s,r,u,d,f,e,o,n,q[0],q[1],l[0],l[1]];return t};var c=function(){return[{x:f,y:e},{x:q[0],y:q[1]},{x:l[0],y:l[1]},{x:o,y:n}]};var m=function(x,w,y){if(y){w=jsBezier.locationAlongCurveFrom(x,w>0?0:1,w)}return w};this.pointOnPath=function(w,y){var x=c();w=m(x,w,y);return jsBezier.pointOnCurve(x,w)};this.gradientAtPoint=function(w,y){var x=c();w=m(x,w,y);return jsBezier.gradientAtPoint(x,w)};this.pointAlongPathFrom=function(w,z,y){var x=c();w=m(x,w,y);return jsBezier.pointAlongCurveFrom(x,w,z)}};jsPlumb.Connectors.Flowchart=function(v){this.type="Flowchart";v=v||{};var n=this,c=v.stub||v.minStubLength||30,f=jsPlumbUtil.isArray(c)?c[0]:c,k=jsPlumbUtil.isArray(c)?c[1]:c,p=v.gap||0,q=[],i=0,d=[],m=[],r=[],o,l,u=-Infinity,s=-Infinity,w=Infinity,t=Infinity,x=function(z,y,D,C){var B=0;for(var A=0;A<q.length;A++){m[A]=q[A][5]/i;d[A]=[B,(B+=(q[A][5]/i))]}},h=function(){r.push(q.length);for(var y=0;y<q.length;y++){r.push(q[y][0]);r.push(q[y][1])}},g=function(I,F,H,G,E,D){var A=q.length==0?H:q[q.length-1][0],z=q.length==0?G:q[q.length-1][1],B=I==A?Infinity:0,C=Math.abs(I==A?F-z:I-A);q.push([I,F,A,z,B,C]);i+=C;u=Math.max(u,I);s=Math.max(s,F);w=Math.min(w,I);t=Math.min(t,F)},e=function(A,C){if(C){A=A>0?A/i:(i+A)/i}var y=d.length-1,z=1;for(var B=0;B<d.length;B++){if(d[B][1]>=A){y=B;z=(A-d[B][0])/m[B];break}}return{segment:q[y],proportion:z,index:y}};this.compute=function(W,ak,z,Q,av,K,U,P,ap,am){q=[];d=[];i=0;m=[];u=s=-Infinity;w=t=Infinity;o=ak[0]<W[0];l=ak[1]<W[1];var aa=U||1,E=(aa/2)+(f+k),B=(aa/2)+(k+f),D=(aa/2)+(f+k),A=(aa/2)+(k+f),N=av.orientation||av.getOrientation(z),aw=K.orientation||K.getOrientation(Q),aj=o?ak[0]:W[0],ai=l?ak[1]:W[1],al=Math.abs(ak[0]-W[0])+E+B,au=Math.abs(ak[1]-W[1])+D+A;if(N[0]==0&&N[1]==0||aw[0]==0&&aw[1]==0){var ac=al>au?0:1,ae=[1,0][ac];N=[];aw=[];N[ac]=W[ac]>ak[ac]?-1:1;aw[ac]=W[ac]>ak[ac]?1:-1;N[ae]=0;aw[ae]=0}if(al<P){E+=(P-al)/2;al=P}if(au<P){D+=(P-au)/2;au=P}var I=o?(al-B)+(p*N[0]):E+(p*N[0]),H=l?(au-A)+(p*N[1]):D+(p*N[1]),ar=o?E+(p*aw[0]):(al-B)+(p*aw[0]),aq=l?D+(p*aw[1]):(au-A)+(p*aw[1]),Z=I+(N[0]*f),Y=H+(N[1]*f),L=ar+(aw[0]*k),J=aq+(aw[1]*k),V=Math.abs(I-ar)>(f+k),X=Math.abs(H-aq)>(f+k),ah=Z+((L-Z)/2),af=Y+((J-Y)/2),O=((N[0]*aw[0])+(N[1]*aw[1])),ab=O==-1,ad=O==0,C=O==1;aj-=E;ai-=D;r=[aj,ai,al,au,I,H,ar,aq];var ao=[];var S=N[0]==0?"y":"x",M=ab?"opposite":C?"orthogonal":"perpendicular",F=jsPlumbUtil.segment([I,H],[ar,aq]),ag=N[S=="x"?0:1]==-1,R={x:[null,4,3,2,1],y:[null,2,1,4,3]};if(ag){F=R[S][F]}g(Z,Y,I,H,ar,aq);var T=function(az,ay,y,ax){return az+(ay*((1-y)*ax)+Math.max(f,k))},G={oppositex:function(){if(z.elementId==Q.elementId){var y=Y+((1-av.y)*ap.height)+Math.max(f,k);return[[Z,y],[L,y]]}else{if(V&&(F==1||F==2)){return[[ah,H],[ah,aq]]}else{return[[Z,af],[L,af]]}}},orthogonalx:function(){if(F==1||F==2){return[[L,Y]]}else{return[[Z,J]]}},perpendicularx:function(){var y=(aq+H)/2;if((F==1&&aw[1]==1)||(F==2&&aw[1]==-1)){if(Math.abs(ar-I)>Math.max(f,k)){return[[L,Y]]}else{return[[Z,Y],[Z,y],[L,y]]}}else{if((F==3&&aw[1]==-1)||(F==4&&aw[1]==1)){return[[Z,y],[L,y]]}else{if((F==3&&aw[1]==1)||(F==4&&aw[1]==-1)){return[[Z,J]]}else{if((F==1&&aw[1]==-1)||(F==2&&aw[1]==1)){if(Math.abs(ar-I)>Math.max(f,k)){return[[ah,Y],[ah,J]]}else{return[[Z,J]]}}}}}},oppositey:function(){if(z.elementId==Q.elementId){var y=Z+((1-av.x)*ap.width)+Math.max(f,k);return[[y,Y],[y,J]]}else{if(X&&(F==2||F==3)){return[[I,af],[ar,af]]}else{return[[ah,Y],[ah,J]]}}},orthogonaly:function(){if(F==2||F==3){return[[Z,J]]}else{return[[L,Y]]}},perpendiculary:function(){var y=(ar+I)/2;if((F==2&&aw[0]==-1)||(F==3&&aw[0]==1)){if(Math.abs(ar-I)>Math.max(f,k)){return[[Z,J]]}else{return[[Z,af],[L,af]]}}else{if((F==1&&aw[0]==-1)||(F==4&&aw[0]==1)){var y=(ar+I)/2;return[[y,Y],[y,J]]}else{if((F==1&&aw[0]==1)||(F==4&&aw[0]==-1)){return[[L,Y]]}else{if((F==2&&aw[0]==1)||(F==3&&aw[0]==-1)){if(Math.abs(aq-H)>Math.max(f,k)){return[[Z,af],[L,af]]}else{return[[L,Y]]}}}}}}};var an=G[M+S]();if(an){for(var at=0;at<an.length;at++){g(an[at][0],an[at][1],I,H,ar,aq)}}g(L,J,I,H,ar,aq);g(ar,aq,I,H,ar,aq);h();x(I,H,ar,aq);if(s>r[3]){r[3]=s+(U*2)}if(u>r[2]){r[2]=u+(U*2)}return r};this.pointOnPath=function(y,z){return n.pointAlongPathFrom(y,0,z)};this.gradientAtPoint=function(y,z){return q[e(y,z)["index"]][4]};this.pointAlongPathFrom=function(F,y,E){var G=e(F,E),C=G.segment,z=G.proportion,B=q[G.index][5],A=q[G.index][4];var D={x:A==Infinity?C[2]:C[2]>C[0]?C[0]+((1-z)*B)-y:C[2]+(z*B)+y,y:A==0?C[3]:C[3]>C[1]?C[1]+((1-z)*B)-y:C[3]+(z*B)+y,segmentInfo:G};return D}};jsPlumb.Endpoints.Dot=function(d){this.type="Dot";var c=this;d=d||{};this.radius=d.radius||10;this.defaultOffset=0.5*this.radius;this.defaultInnerRadius=this.radius/3;this.compute=function(i,f,l,h){var g=l.radius||c.radius,e=i[0]-g,k=i[1]-g;return[e,k,g*2,g*2,g]}};jsPlumb.Endpoints.Rectangle=function(d){this.type="Rectangle";var c=this;d=d||{};this.width=d.width||20;this.height=d.height||20;this.compute=function(k,g,m,i){var h=m.width||c.width,f=m.height||c.height,e=k[0]-(h/2),l=k[1]-(f/2);return[e,l,h,f]}};var a=function(e){jsPlumb.DOMElementComponent.apply(this,arguments);var c=this;var d=[];this.getDisplayElements=function(){return d};this.appendDisplayElement=function(f){d.push(f)}};jsPlumb.Endpoints.Image=function(g){this.type="Image";a.apply(this,arguments);var l=this,f=false,e=g.width,d=g.height,i=null,c=g.endpoint;this.img=new Image();l.ready=false;this.img.onload=function(){l.ready=true;e=e||l.img.width;d=d||l.img.height;if(i){i(l)}};c.setImage=function(m,o){var n=m.constructor==String?m:m.src;i=o;l.img.src=m;if(l.canvas!=null){l.canvas.setAttribute("src",m)}};c.setImage(g.src||g.url,g.onload);this.compute=function(o,m,p,n){l.anchorPoint=o;if(l.ready){return[o[0]-e/2,o[1]-d/2,e,d]}else{return[0,0,0,0]}};l.canvas=document.createElement("img"),f=false;l.canvas.style.margin=0;l.canvas.style.padding=0;l.canvas.style.outline=0;l.canvas.style.position="absolute";var h=g.cssClass?" "+g.cssClass:"";l.canvas.className=jsPlumb.endpointClass+h;if(e){l.canvas.setAttribute("width",e)}if(d){l.canvas.setAttribute("height",d)}jsPlumb.appendElement(l.canvas,g.parent);l.attachListeners(l.canvas,l);var k=function(p,o,n){if(!f){l.canvas.setAttribute("src",l.img.src);l.appendDisplayElement(l.canvas);f=true}var m=l.anchorPoint[0]-(e/2),q=l.anchorPoint[1]-(d/2);jsPlumb.sizeCanvas(l.canvas,m,q,e,d)};this.paint=function(o,n,m){if(l.ready){k(o,n,m)}else{window.setTimeout(function(){l.paint(o,n,m)},200)}}};jsPlumb.Endpoints.Blank=function(d){var c=this;this.type="Blank";a.apply(this,arguments);this.compute=function(g,e,h,f){return[g[0],g[1],10,0]};c.canvas=document.createElement("div");c.canvas.style.display="block";c.canvas.style.width="1px";c.canvas.style.height="1px";c.canvas.style.background="transparent";c.canvas.style.position="absolute";c.canvas.className=c._jsPlumb.endpointClass;jsPlumb.appendElement(c.canvas,d.parent);this.paint=function(g,f,e){jsPlumb.sizeCanvas(c.canvas,g[0],g[1],g[2],g[3])}};jsPlumb.Endpoints.Triangle=function(c){this.type="Triangle";c=c||{};c.width=c.width||55;c.height=c.height||55;this.width=c.width;this.height=c.height;this.compute=function(i,f,l,h){var g=l.width||self.width,e=l.height||self.height,d=i[0]-(g/2),k=i[1]-(e/2);return[d,k,g,e]}};var b=function(e){var d=true,c=this;this.isAppendedAtTopLevel=true;this.component=e.component;this.loc=e.location==null?0.5:e.location;this.endpointLoc=e.endpointLocation==null?[0.5,0.5]:e.endpointLocation;this.setVisible=function(f){d=f;c.component.repaint()};this.isVisible=function(){return d};this.hide=function(){c.setVisible(false)};this.show=function(){c.setVisible(true)};this.incrementLocation=function(f){c.loc+=f;c.component.repaint()};this.setLocation=function(f){c.loc=f;c.component.repaint()};this.getLocation=function(){return c.loc}};jsPlumb.Overlays.Arrow=function(g){this.type="Arrow";b.apply(this,arguments);this.isAppendedAtTopLevel=false;g=g||{};var d=this;this.length=g.length||20;this.width=g.width||20;this.id=g.id;var f=(g.direction||1)<0?-1:1,e=g.paintStyle||{lineWidth:1},c=g.foldback||0.623;this.computeMaxSize=function(){return d.width*1.5};this.cleanup=function(){};this.draw=function(k,z,u){var o,v,h,p,n;if(k.pointAlongPathFrom){if(jsPlumbUtil.isString(d.loc)||d.loc>1||d.loc<0){var i=parseInt(d.loc);o=k.pointAlongPathFrom(i,f*d.length/2,true),v=k.pointOnPath(i,true),h=jsPlumbUtil.pointOnLine(o,v,d.length)}else{if(d.loc==1){o=k.pointOnPath(d.loc);v=k.pointAlongPathFrom(d.loc,-1);h=jsPlumbUtil.pointOnLine(o,v,d.length)}else{if(d.loc==0){h=k.pointOnPath(d.loc);v=k.pointAlongPathFrom(d.loc,1);o=jsPlumbUtil.pointOnLine(h,v,d.length)}else{o=k.pointAlongPathFrom(d.loc,f*d.length/2),v=k.pointOnPath(d.loc),h=jsPlumbUtil.pointOnLine(o,v,d.length)}}}p=jsPlumbUtil.perpendicularLineTo(o,h,d.width);n=jsPlumbUtil.pointOnLine(o,h,c*d.length);var y=Math.min(o.x,p[0].x,p[1].x),s=Math.max(o.x,p[0].x,p[1].x),x=Math.min(o.y,p[0].y,p[1].y),r=Math.max(o.y,p[0].y,p[1].y);var q={hxy:o,tail:p,cxy:n},t=e.strokeStyle||z.strokeStyle,w=e.fillStyle||z.strokeStyle,m=e.lineWidth||z.lineWidth;d.paint(k,q,m,t,w,u);return[y,s,x,r]}else{return[0,0,0,0]}}};jsPlumb.Overlays.PlainArrow=function(d){d=d||{};var c=jsPlumb.extend(d,{foldback:1});jsPlumb.Overlays.Arrow.call(this,c);this.type="PlainArrow"};jsPlumb.Overlays.Diamond=function(e){e=e||{};var c=e.length||40,d=jsPlumb.extend(e,{length:c/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,d);this.type="Diamond"};jsPlumb.Overlays.Label=function(i){this.type="Label";jsPlumb.DOMElementComponent.apply(this,arguments);b.apply(this,arguments);this.labelStyle=i.labelStyle||jsPlumb.Defaults.LabelStyle;this.id=i.id;this.cachedDimensions=null;var e=i.label||"",c=this,f=false,k=document.createElement("div"),g=null;k.style.position="absolute";var d=i._jsPlumb.overlayClass+" "+(c.labelStyle.cssClass?c.labelStyle.cssClass:i.cssClass?i.cssClass:"");k.className=d;jsPlumb.appendElement(k,i.component.parent);jsPlumb.getId(k);c.attachListeners(k,c);c.canvas=k;var h=c.setVisible;c.setVisible=function(l){h(l);k.style.display=l?"block":"none"};this.getElement=function(){return k};this.cleanup=function(){if(k!=null){jsPlumb.CurrentLibrary.removeElement(k)}};this.setLabel=function(m){e=m;g=null;c.component.repaint()};this.getLabel=function(){return e};this.paint=function(l,n,m){if(!f){l.appendDisplayElement(k);c.attachListeners(k,l);f=true}k.style.left=(m[0]+n.minx)+"px";k.style.top=(m[1]+n.miny)+"px"};this.getTextDimensions=function(){if(typeof e=="function"){var l=e(c);k.innerHTML=l.replace(/\r\n/g,"<br/>")}else{if(g==null){g=e;k.innerHTML=g.replace(/\r\n/g,"<br/>")}}var n=jsPlumb.CurrentLibrary.getElementObject(k),m=jsPlumb.CurrentLibrary.getSize(n);return{width:m[0],height:m[1]}};this.computeMaxSize=function(l){var m=c.getTextDimensions(l);return m.width?Math.max(m.width,m.height)*1.5:0};this.draw=function(m,n,o){var s=c.getTextDimensions(m);if(s.width!=null){var p={x:0,y:0};if(m.pointOnPath){var q=c.loc,r=false;if(jsPlumbUtil.isString(c.loc)||c.loc<0||c.loc>1){q=parseInt(c.loc);r=true}p=m.pointOnPath(q,r)}else{var l=c.loc.constructor==Array?c.loc:c.endpointLoc;p={x:l[0]*o[2],y:l[1]*o[3]}}minx=p.x-(s.width/2),miny=p.y-(s.height/2);c.paint(m,{minx:minx,miny:miny,td:s,cxy:p},o);return[minx,minx+s.width,miny,miny+s.height]}else{return[0,0,0,0]}};this.reattachListeners=function(l){if(k){c.reattachListenersForElement(k,c,l)}}};jsPlumb.Overlays.GuideLines=function(){var c=this;c.length=50;c.lineWidth=5;this.type="GuideLines";b.apply(this,arguments);jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.draw=function(e,l,k){var i=e.pointAlongPathFrom(c.loc,c.length/2),h=e.pointOnPath(c.loc),g=jsPlumbUtil.pointOnLine(i,h,c.length),f=jsPlumbUtil.perpendicularLineTo(i,g,40),d=jsPlumbUtil.perpendicularLineTo(g,i,20);c.paint(e,[i,g,f,d],c.lineWidth,"red",null,k);return[Math.min(i.x,g.x),Math.min(i.y,g.y),Math.max(i.x,g.x),Math.max(i.y,g.y)]};this.computeMaxSize=function(){return 50};this.cleanup=function(){}}})();(function(){var c=function(e,g,d,f){this.m=(f-g)/(d-e);this.b=-1*((this.m*e)-g);this.rectIntersect=function(q,p,s,o){var n=[];var k=(p-this.b)/this.m;if(k>=q&&k<=(q+s)){n.push([k,(this.m*k)+this.b])}var t=(this.m*(q+s))+this.b;if(t>=p&&t<=(p+o)){n.push([(t-this.b)/this.m,t])}var k=((p+o)-this.b)/this.m;if(k>=q&&k<=(q+s)){n.push([k,(this.m*k)+this.b])}var t=(this.m*q)+this.b;if(t>=p&&t<=(p+o)){n.push([(t-this.b)/this.m,t])}if(n.length==2){var m=(n[0][0]+n[1][0])/2,l=(n[0][1]+n[1][1])/2;n.push([m,l]);var i=m<=q+(s/2)?-1:1,r=l<=p+(o/2)?-1:1;n.push([i,r]);return n}return null}},a=function(e,g,d,f){if(e<=d&&f<=g){return 1}else{if(e<=d&&g<=f){return 2}else{if(d<=e&&f>=g){return 3}}}return 4},b=function(g,f,i,e,h,m,l,d,k){if(d<=k){return[g,f]}if(i==1){if(e[3]<=0&&h[3]>=1){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]>=1&&h[2]<=0){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(-1*m),f+(-1*l)]}}}else{if(i==2){if(e[3]>=1&&h[3]<=0){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]>=1&&h[2]<=0){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(1*m),f+(-1*l)]}}}else{if(i==3){if(e[3]>=1&&h[3]<=0){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]<=0&&h[2]>=1){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(-1*m),f+(-1*l)]}}}else{if(i==4){if(e[3]<=0&&h[3]>=1){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]<=0&&h[2]>=1){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(1*m),f+(-1*l)]}}}}}}};jsPlumb.Connectors.StateMachine=function(l){var u=this,n=null,o,m,g,e,p=[],d=l.curviness||10,k=l.margin||5,q=l.proximityLimit||80,f=l.orientation&&l.orientation=="clockwise",i=l.loopbackRadius||25,h=false,t=l.showLoopback!==false;this.type="StateMachine";l=l||{};this.compute=function(ad,H,W,I,ac,z,v,U){var Q=Math.abs(ad[0]-H[0]),Y=Math.abs(ad[1]-H[1]),S=0.45*Q,ab=0.45*Y;Q*=1.9;Y*=1.9;v=v||1;var O=Math.min(ad[0],H[0])-S,M=Math.min(ad[1],H[1])-ab;if(!t||(W.elementId!=I.elementId)){h=false;o=ad[0]<H[0]?S:Q-S;m=ad[1]<H[1]?ab:Y-ab;g=ad[0]<H[0]?Q-S:S;e=ad[1]<H[1]?Y-ab:ab;if(ad[2]==0){o-=k}if(ad[2]==1){o+=k}if(ad[3]==0){m-=k}if(ad[3]==1){m+=k}if(H[2]==0){g-=k}if(H[2]==1){g+=k}if(H[3]==0){e-=k}if(H[3]==1){e+=k}var N=(o+g)/2,L=(m+e)/2,A=(-1*N)/L,V=Math.atan(A),P=(A==Infinity||A==-Infinity)?0:Math.abs(d/2*Math.sin(V)),R=(A==Infinity||A==-Infinity)?0:Math.abs(d/2*Math.cos(V)),B=a(o,m,g,e),J=Math.sqrt(Math.pow(g-o,2)+Math.pow(e-m,2));p=b(N,L,B,ad,H,d,d,J,q);var G=Math.max(Math.abs(p[0]-o)*3,Math.abs(p[0]-g)*3,Math.abs(g-o),2*v,U),K=Math.max(Math.abs(p[1]-m)*3,Math.abs(p[1]-e)*3,Math.abs(e-m),2*v,U);if(Q<G){var T=G-Q;O-=(T/2);o+=(T/2);g+=(T/2);Q=G;p[0]+=(T/2)}if(Y<K){var aa=K-Y;M-=(aa/2);m+=(aa/2);e+=(aa/2);Y=K;p[1]+=(aa/2)}n=[O,M,Q,Y,o,m,g,e,p[0],p[1]]}else{h=true;var Z=ad[0],X=ad[0],F=ad[1]-k,D=ad[1]-k,E=Z,C=F-i;Q=((2*v)+(4*i)),Y=((2*v)+(4*i));O=E-i-v-i,M=C-i-v-i;n=[O,M,Q,Y,E-O,C-M,i,f,Z-O,F-M,X-O,D-M]}return n};var r=function(){return[{x:g,y:e},{x:p[0],y:p[1]},{x:p[0]+1,y:p[1]+1},{x:o,y:m}]};var s=function(w,v,x){if(x){v=jsBezier.locationAlongCurveFrom(w,v>0?0:1,v)}return v};this.pointOnPath=function(x,B){if(h){if(B){var y=Math.PI*2*i;x=x/y}if(x>0&&x<1){x=1-x}var z=(x*2*Math.PI)+(Math.PI/2),w=n[4]+(n[6]*Math.cos(z)),v=n[5]+(n[6]*Math.sin(z));return{x:w,y:v}}else{var A=r();x=s(A,x,B);return jsBezier.pointOnCurve(A,x)}};this.gradientAtPoint=function(v,y){if(h){if(y){var w=Math.PI*2*i;v=v/w}return Math.atan(v*2*Math.PI)}else{var x=r();v=s(x,v,y);return jsBezier.gradientAtPoint(x,v)}};this.pointAlongPathFrom=function(D,v,C){if(h){if(C){var B=Math.PI*2*i;D=D/B}if(D>0&&D<1){D=1-D}var B=2*Math.PI*n[6],w=v/B*2*Math.PI,z=(D*2*Math.PI)-w+(Math.PI/2),y=n[4]+(n[6]*Math.cos(z)),x=n[5]+(n[6]*Math.sin(z));return{x:y,y:x}}else{var A=r();D=s(A,D,C);return jsBezier.pointAlongCurveFrom(A,D,v)}}};jsPlumb.Connectors.canvas.StateMachine=function(f){f=f||{};var d=this,g=f.drawGuideline||true,e=f.avoidSelector;jsPlumb.Connectors.StateMachine.apply(this,arguments);jsPlumb.CanvasConnector.apply(this,arguments);this._paint=function(l){if(l.length==10){d.ctx.beginPath();d.ctx.moveTo(l[4],l[5]);d.ctx.bezierCurveTo(l[8],l[9],l[8],l[9],l[6],l[7]);d.ctx.stroke()}else{d.ctx.save();d.ctx.beginPath();var k=0,i=2*Math.PI,h=l[7];d.ctx.arc(l[4],l[5],l[6],0,i,h);d.ctx.stroke();d.ctx.closePath();d.ctx.restore()}};this.createGradient=function(i,h){return h.createLinearGradient(i[4],i[5],i[6],i[7])}};jsPlumb.Connectors.svg.StateMachine=function(){var d=this;jsPlumb.Connectors.StateMachine.apply(this,arguments);jsPlumb.SvgConnector.apply(this,arguments);this.getPath=function(e){if(e.length==10){return"M "+e[4]+" "+e[5]+" C "+e[8]+" "+e[9]+" "+e[8]+" "+e[9]+" "+e[6]+" "+e[7]}else{return"M"+(e[8]+4)+" "+e[9]+" A "+e[6]+" "+e[6]+" 0 1,0 "+(e[8]-4)+" "+e[9]}}};jsPlumb.Connectors.vml.StateMachine=function(){jsPlumb.Connectors.StateMachine.apply(this,arguments);jsPlumb.VmlConnector.apply(this,arguments);var d=jsPlumb.vml.convertValue;this.getPath=function(k){if(k.length==10){return"m"+d(k[4])+","+d(k[5])+" c"+d(k[8])+","+d(k[9])+","+d(k[8])+","+d(k[9])+","+d(k[6])+","+d(k[7])+" e"}else{var h=d(k[8]-k[6]),g=d(k[9]-(2*k[6])),f=h+d(2*k[6]),e=g+d(2*k[6]),l=h+","+g+","+f+","+e;var i="ar "+l+","+d(k[8])+","+d(k[9])+","+d(k[8])+","+d(k[9])+" e";return i}}}})();(function(){var h={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},c=null;if(document.createStyleSheet&&document.namespaces){var m=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],g="behavior:url(#default#VML);position:absolute;";c=document.createStyleSheet();for(var r=0;r<m.length;r++){c.addRule(m[r],g)}document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var t=1000,s={},a=function(u,i){var w=jsPlumb.getId(u),v=s[w];if(!v){v=f("group",[0,0,t,t],{"class":i});v.style.backgroundColor="red";s[w]=v;jsPlumb.appendElement(v,u)}return v},e=function(v,w){for(var u in w){v[u]=w[u]}},f=function(u,x,y,v,i){y=y||{};var w=document.createElement("jsplumb:"+u);i.appendElement(w,v);w.className=(y["class"]?y["class"]+" ":"")+"jsplumb_vml";k(w,x);e(w,y);return w},k=function(u,i){u.style.left=i[0]+"px";u.style.top=i[1]+"px";u.style.width=i[2]+"px";u.style.height=i[3]+"px";u.style.position="absolute"},p=jsPlumb.vml.convertValue=function(i){return Math.floor(i*t)},b=function(w,u,v,i){if("transparent"===u){i.setOpacity(v,"0.0")}else{i.setOpacity(v,"1.0")}},q=function(y,u,B,C){var x={};if(u.strokeStyle){x.stroked="true";var D=jsPlumbUtil.convertStyle(u.strokeStyle,true);x.strokecolor=D;b(x,D,"stroke",B);x.strokeweight=u.lineWidth+"px"}else{x.stroked="false"}if(u.fillStyle){x.filled="true";var v=jsPlumbUtil.convertStyle(u.fillStyle,true);x.fillcolor=v;b(x,v,"fill",B)}else{x.filled="false"}if(u.dashstyle){if(B.strokeNode==null){B.strokeNode=f("stroke",[0,0,0,0],{dashstyle:u.dashstyle},y,C)}else{B.strokeNode.dashstyle=u.dashstyle}}else{if(u["stroke-dasharray"]&&u.lineWidth){var E=u["stroke-dasharray"].indexOf(",")==-1?" ":",",z=u["stroke-dasharray"].split(E),w="";for(var A=0;A<z.length;A++){w+=(Math.floor(z[A]/u.lineWidth)+E)}if(B.strokeNode==null){B.strokeNode=f("stroke",[0,0,0,0],{dashstyle:w},y,C)}else{B.strokeNode.dashstyle=w}}}e(y,x)},n=function(){var i=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.opacityNodes={stroke:null,fill:null};this.initOpacityNodes=function(v){i.opacityNodes.stroke=f("stroke",[0,0,1,1],{opacity:"0.0"},v,i._jsPlumb);i.opacityNodes.fill=f("fill",[0,0,1,1],{opacity:"0.0"},v,i._jsPlumb)};this.setOpacity=function(v,x){var w=i.opacityNodes[v];if(w){w.opacity=""+x}};var u=[];this.getDisplayElements=function(){return u};this.appendDisplayElement=function(w,v){if(!v){i.canvas.parentNode.appendChild(w)}u.push(w)}},d=jsPlumb.VmlConnector=function(v){var i=this;i.strokeNode=null;i.canvas=null;n.apply(this,arguments);var u=i._jsPlumb.connectorClass+(v.cssClass?(" "+v.cssClass):"");this.paint=function(A,x,z){if(x!=null){var E=i.getPath(A),y={path:E};if(x.outlineColor){var C=x.outlineWidth||1,D=x.lineWidth+(2*C),B={strokeStyle:jsPlumbUtil.convertStyle(x.outlineColor),lineWidth:D};for(var w in h){B[w]=x[w]}if(i.bgCanvas==null){y["class"]=u;y.coordsize=(A[2]*t)+","+(A[3]*t);i.bgCanvas=f("shape",A,y,v.parent,i._jsPlumb);k(i.bgCanvas,A);i.appendDisplayElement(i.bgCanvas,true);i.attachListeners(i.bgCanvas,i);i.initOpacityNodes(i.bgCanvas,["stroke"])}else{y.coordsize=(A[2]*t)+","+(A[3]*t);k(i.bgCanvas,A);e(i.bgCanvas,y)}q(i.bgCanvas,B,i)}if(i.canvas==null){y["class"]=u;y.coordsize=(A[2]*t)+","+(A[3]*t);if(i.tooltip){y.label=i.tooltip}i.canvas=f("shape",A,y,v.parent,i._jsPlumb);i.appendDisplayElement(i.canvas,true);i.attachListeners(i.canvas,i);i.initOpacityNodes(i.canvas,["stroke"])}else{y.coordsize=(A[2]*t)+","+(A[3]*t);k(i.canvas,A);e(i.canvas,y)}q(i.canvas,x,i,i._jsPlumb)}};this.reattachListeners=function(){if(i.canvas){i.reattachListenersForElement(i.canvas,i)}}},l=window.VmlEndpoint=function(y){n.apply(this,arguments);var i=null,v=this,u=null,x=null;v.canvas=document.createElement("div");v.canvas.style.position="absolute";var w=v._jsPlumb.endpointClass+(y.cssClass?(" "+y.cssClass):"");y._jsPlumb.appendElement(v.canvas,y.parent);if(v.tooltip){v.canvas.setAttribute("label",v.tooltip)}this.paint=function(C,A,z){var B={};jsPlumb.sizeCanvas(v.canvas,C[0],C[1],C[2],C[3]);if(i==null){B["class"]=w;i=v.getVml([0,0,C[2],C[3]],B,z,v.canvas,v._jsPlumb);v.attachListeners(i,v);v.appendDisplayElement(i,true);v.appendDisplayElement(v.canvas,true);v.initOpacityNodes(i,["fill"])}else{k(i,[0,0,C[2],C[3]]);e(i,B)}q(i,A,v)};this.reattachListeners=function(){if(i){v.reattachListenersForElement(i,v)}}};jsPlumb.Connectors.vml.Bezier=function(){jsPlumb.Connectors.Bezier.apply(this,arguments);d.apply(this,arguments);this.getPath=function(i){return"m"+p(i[4])+","+p(i[5])+" c"+p(i[8])+","+p(i[9])+","+p(i[10])+","+p(i[11])+","+p(i[6])+","+p(i[7])+" e"}};jsPlumb.Connectors.vml.Straight=function(){jsPlumb.Connectors.Straight.apply(this,arguments);d.apply(this,arguments);this.getPath=function(i){return"m"+p(i[4])+","+p(i[5])+" l"+p(i[6])+","+p(i[7])+" e"}};jsPlumb.Connectors.vml.Flowchart=function(){jsPlumb.Connectors.Flowchart.apply(this,arguments);d.apply(this,arguments);this.getPath=function(v){var w="m "+p(v[4])+","+p(v[5])+" l";for(var u=0;u<v[8];u++){w=w+" "+p(v[9+(u*2)])+","+p(v[10+(u*2)])}w=w+" "+p(v[6])+","+p(v[7])+" e";return w}};jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);l.apply(this,arguments);this.getVml=function(w,x,u,v,i){return f("oval",w,x,v,i)}};jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);l.apply(this,arguments);this.getVml=function(w,x,u,v,i){return f("rect",w,x,v,i)}};jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label;var o=function(x,v){x.apply(this,v);n.apply(this,v);var u=this,w=null;u.canvas=null;u.isAppendedAtTopLevel=true;var i=function(z,y){return"m "+p(z.hxy.x)+","+p(z.hxy.y)+" l "+p(z.tail[0].x)+","+p(z.tail[0].y)+" "+p(z.cxy.x)+","+p(z.cxy.y)+" "+p(z.tail[1].x)+","+p(z.tail[1].y)+" x e"};this.paint=function(B,G,F,H,L,K){var z={};if(H){z.stroked="true";z.strokecolor=jsPlumbUtil.convertStyle(H,true)}if(F){z.strokeweight=F+"px"}if(L){z.filled="true";z.fillcolor=L}var y=Math.min(G.hxy.x,G.tail[0].x,G.tail[1].x,G.cxy.x),J=Math.min(G.hxy.y,G.tail[0].y,G.tail[1].y,G.cxy.y),C=Math.max(G.hxy.x,G.tail[0].x,G.tail[1].x,G.cxy.x),A=Math.max(G.hxy.y,G.tail[0].y,G.tail[1].y,G.cxy.y),I=Math.abs(C-y),E=Math.abs(A-J),D=[y,J,I,E];z.path=i(G,K);z.coordsize=(K[2]*t)+","+(K[3]*t);D[0]=K[0];D[1]=K[1];D[2]=K[2];D[3]=K[3];if(u.canvas==null){u.canvas=f("shape",D,z,B.canvas.parentNode,B._jsPlumb);B.appendDisplayElement(u.canvas,true);u.attachListeners(u.canvas,B);u.attachListeners(u.canvas,u)}else{k(u.canvas,D);e(u.canvas,z)}};this.reattachListeners=function(){if(u.canvas){u.reattachListenersForElement(u.canvas,u)}};this.cleanup=function(){if(u.canvas!=null){jsPlumb.CurrentLibrary.removeElement(u.canvas)}}};jsPlumb.Overlays.vml.Arrow=function(){o.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumb.Overlays.vml.PlainArrow=function(){o.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumb.Overlays.vml.Diamond=function(){o.apply(this,[jsPlumb.Overlays.Diamond,arguments])}})();(function(){var l={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},w="stroke-dasharray",A="dashstyle",e="linearGradient",b="radialGradient",c="fill",a="stop",z="stroke",q="stroke-width",h="style",m="none",t="jsplumb_gradient_",o="lineWidth",C={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},g=function(F,D){for(var E in D){F.setAttribute(E,""+D[E])}},f=function(E,D){var F=document.createElementNS(C.svg,E);D=D||{};D.version="1.1";D.xmlns=C.xhtml;g(F,D);return F},n=function(D){return"position:absolute;left:"+D[0]+"px;top:"+D[1]+"px"},i=function(E){for(var D=0;D<E.childNodes.length;D++){if(E.childNodes[D].tagName==e||E.childNodes[D].tagName==b){E.removeChild(E.childNodes[D])}}},v=function(N,I,F,D,J){var G=t+J._jsPlumb.idstamp();i(N);if(!F.gradient.offset){var L=f(e,{id:G,gradientUnits:"userSpaceOnUse"});N.appendChild(L)}else{var L=f(b,{id:G});N.appendChild(L)}for(var K=0;K<F.gradient.stops.length;K++){var H=K;if(D.length==8){H=D[4]<D[6]?K:F.gradient.stops.length-1-K}else{H=D[4]<D[6]?F.gradient.stops.length-1-K:K}var M=jsPlumbUtil.convertStyle(F.gradient.stops[H][1],true);var O=f(a,{offset:Math.floor(F.gradient.stops[K][0]*100)+"%","stop-color":M});L.appendChild(O)}var E=F.strokeStyle?z:c;I.setAttribute(h,E+":url(#"+G+")")},x=function(K,G,E,D,H){if(E.gradient){v(K,G,E,D,H)}else{i(K);G.setAttribute(h,"")}G.setAttribute(c,E.fillStyle?jsPlumbUtil.convertStyle(E.fillStyle,true):m);G.setAttribute(z,E.strokeStyle?jsPlumbUtil.convertStyle(E.strokeStyle,true):m);if(E.lineWidth){G.setAttribute(q,E.lineWidth)}if(E[A]&&E[o]&&!E[w]){var L=E[A].indexOf(",")==-1?" ":",",I=E[A].split(L),F="";I.forEach(function(M){F+=(Math.floor(M*E.lineWidth)+L)});G.setAttribute(w,F)}else{if(E[w]){G.setAttribute(w,E[w])}}for(var J in l){if(E[J]){G.setAttribute(l[J],E[J])}}},B=function(F){var D=/([0-9].)(p[xt])\s(.*)/;var E=F.match(D);return{size:E[1]+E[2],font:E[3]}},r=function(I,J,E){var K=E.split(" "),H=I.className,G=H.baseVal.split(" ");for(var F=0;F<K.length;F++){if(J){if(G.indexOf(K[F])==-1){G.push(K[F])}}else{var D=G.indexOf(K[F]);if(D!=-1){G.splice(D,1)}}}I.className.baseVal=G.join(" ")},u=function(E,D){r(E,true,D)},k=function(E,D){r(E,false,D)};jsPlumbUtil.svg={addClass:u,removeClass:k,node:f,attr:g,pos:n};var s=function(H){var D=this,G=H.pointerEventsSpec||"all";jsPlumb.jsPlumbUIComponent.apply(this,H.originalArgs);D.canvas=null,D.path=null,D.svg=null;var F=H.cssClass+" "+(H.originalArgs[0].cssClass||""),I={style:"",width:0,height:0,"pointer-events":G,position:"absolute"};if(D.tooltip){I.title=D.tooltip}D.svg=f("svg",I);if(H.useDivWrapper){D.canvas=document.createElement("div");D.canvas.style.position="absolute";jsPlumb.sizeCanvas(D.canvas,0,0,1,1);D.canvas.className=F;if(D.tooltip){D.canvas.setAttribute("title",D.tooltip)}}else{g(D.svg,{"class":F});D.canvas=D.svg}H._jsPlumb.appendElement(D.canvas,H.originalArgs[0]["parent"]);if(H.useDivWrapper){D.canvas.appendChild(D.svg)}var E=[D.canvas];this.getDisplayElements=function(){return E};this.appendDisplayElement=function(J){E.push(J)};this.paint=function(M,L,K){if(L!=null){var J=M[0],N=M[1];if(H.useDivWrapper){jsPlumb.sizeCanvas(D.canvas,M[0],M[1],M[2],M[3]);J=0,N=0}g(D.svg,{style:n([J,N,M[2],M[3]]),width:M[2],height:M[3]});D._paint.apply(this,arguments)}}};var d=jsPlumb.SvgConnector=function(E){var D=this;s.apply(this,[{cssClass:E._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",tooltip:E.tooltip,_jsPlumb:E._jsPlumb}]);this._paint=function(L,H){var K=D.getPath(L),F={d:K},J=null;F["pointer-events"]="all";if(H.outlineColor){var I=H.outlineWidth||1,G=H.lineWidth+(2*I),J=jsPlumb.CurrentLibrary.extend({},H);J.strokeStyle=jsPlumbUtil.convertStyle(H.outlineColor);J.lineWidth=G;if(D.bgPath==null){D.bgPath=f("path",F);D.svg.appendChild(D.bgPath);D.attachListeners(D.bgPath,D)}else{g(D.bgPath,F)}x(D.svg,D.bgPath,J,L,D)}if(D.path==null){D.path=f("path",F);D.svg.appendChild(D.path);D.attachListeners(D.path,D)}else{g(D.path,F)}x(D.svg,D.path,H,L,D)};this.reattachListeners=function(){if(D.bgPath){D.reattachListenersForElement(D.bgPath,D)}if(D.path){D.reattachListenersForElement(D.path,D)}}};jsPlumb.Connectors.svg.Bezier=function(D){jsPlumb.Connectors.Bezier.apply(this,arguments);d.apply(this,arguments);this.getPath=function(F){var E="M "+F[4]+" "+F[5];E+=(" C "+F[8]+" "+F[9]+" "+F[10]+" "+F[11]+" "+F[6]+" "+F[7]);return E}};jsPlumb.Connectors.svg.Straight=function(D){jsPlumb.Connectors.Straight.apply(this,arguments);d.apply(this,arguments);this.getPath=function(E){return"M "+E[4]+" "+E[5]+" L "+E[6]+" "+E[7]}};jsPlumb.Connectors.svg.Flowchart=function(){var D=this;jsPlumb.Connectors.Flowchart.apply(this,arguments);d.apply(this,arguments);this.getPath=function(F){var G="M "+F[4]+","+F[5];for(var E=0;E<F[8];E++){G=G+" L "+F[9+(E*2)]+" "+F[10+(E*2)]}G=G+" "+F[6]+","+F[7];return G}};var y=window.SvgEndpoint=function(E){var D=this;s.apply(this,[{cssClass:E._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:true,_jsPlumb:E._jsPlumb}]);this._paint=function(H,G){var F=jsPlumb.extend({},G);if(F.outlineColor){F.strokeWidth=F.outlineWidth;F.strokeStyle=jsPlumbUtil.convertStyle(F.outlineColor,true)}if(D.node==null){D.node=D.makeNode(H,F);D.svg.appendChild(D.node);D.attachListeners(D.node,D)}x(D.svg,D.node,F,H,D);n(D.node,H)};this.reattachListeners=function(){if(D.node){D.reattachListenersForElement(D.node,D)}}};jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);y.apply(this,arguments);this.makeNode=function(E,D){return f("circle",{cx:E[2]/2,cy:E[3]/2,r:E[2]/2})}};jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);y.apply(this,arguments);this.makeNode=function(E,D){return f("rect",{width:E[2],height:E[3]})}};jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label;var p=function(H,F){H.apply(this,F);jsPlumb.jsPlumbUIComponent.apply(this,F);this.isAppendedAtTopLevel=false;var D=this,G=null;this.paint=function(J,M,I,N,K){if(G==null){G=f("path",{"pointer-events":"all"});J.svg.appendChild(G);D.attachListeners(G,J);D.attachListeners(G,D)}var L=F&&(F.length==1)?(F[0].cssClass||""):"";g(G,{d:E(M),"class":L,stroke:N?N:null,fill:K?K:null})};var E=function(I){return"M"+I.hxy.x+","+I.hxy.y+" L"+I.tail[0].x+","+I.tail[0].y+" L"+I.cxy.x+","+I.cxy.y+" L"+I.tail[1].x+","+I.tail[1].y+" L"+I.hxy.x+","+I.hxy.y};this.reattachListeners=function(){if(G){D.reattachListenersForElement(G,D)}};this.cleanup=function(){if(G!=null){jsPlumb.CurrentLibrary.removeElement(G)}}};jsPlumb.Overlays.svg.Arrow=function(){p.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumb.Overlays.svg.PlainArrow=function(){p.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumb.Overlays.svg.Diamond=function(){p.apply(this,[jsPlumb.Overlays.Diamond,arguments])};jsPlumb.Overlays.svg.GuideLines=function(){var I=null,D=this,H=null,G,F;jsPlumb.Overlays.GuideLines.apply(this,arguments);this.paint=function(K,M,J,N,L){if(I==null){I=f("path");K.svg.appendChild(I);D.attachListeners(I,K);D.attachListeners(I,D);G=f("path");K.svg.appendChild(G);D.attachListeners(G,K);D.attachListeners(G,D);F=f("path");K.svg.appendChild(F);D.attachListeners(F,K);D.attachListeners(F,D)}g(I,{d:E(M[0],M[1]),stroke:"red",fill:null});g(G,{d:E(M[2][0],M[2][1]),stroke:"blue",fill:null});g(F,{d:E(M[3][0],M[3][1]),stroke:"green",fill:null})};var E=function(K,J){return"M "+K.x+","+K.y+" L"+J.x+","+J.y}}})();(function(){var d=null,i=function(p,o){return jsPlumb.CurrentLibrary.hasClass(a(p),o)},a=function(o){return jsPlumb.CurrentLibrary.getElementObject(o)},m=function(o){return jsPlumb.CurrentLibrary.getOffset(a(o))},n=function(o){return jsPlumb.CurrentLibrary.getPageXY(o)},f=function(o){return jsPlumb.CurrentLibrary.getClientXY(o)};var k=function(){var q=this;q.overlayPlacements=[];jsPlumb.jsPlumbUIComponent.apply(this,arguments);jsPlumbUtil.EventGenerator.apply(this,arguments);this._over=function(z){var B=m(a(q.canvas)),D=n(z),u=D[0]-B.left,C=D[1]-B.top;if(u>0&&C>0&&u<q.canvas.width&&C<q.canvas.height){for(var v=0;v<q.overlayPlacements.length;v++){var w=q.overlayPlacements[v];if(w&&(w[0]<=u&&w[1]>=u&&w[2]<=C&&w[3]>=C)){return true}}var A=q.canvas.getContext("2d").getImageData(parseInt(u),parseInt(C),1,1);return A.data[0]!=0||A.data[1]!=0||A.data[2]!=0||A.data[3]!=0}return false};var p=false,o=false,t=null,s=false,r=function(v,u){return v!=null&&i(v,u)};this.mousemove=function(x){var z=n(x),w=f(x),v=document.elementFromPoint(w[0],w[1]),y=r(v,"_jsPlumb_overlay");var u=d==null&&(r(v,"_jsPlumb_endpoint")||r(v,"_jsPlumb_connector"));if(!p&&u&&q._over(x)){p=true;q.fire("mouseenter",q,x);return true}else{if(p&&(!q._over(x)||!u)&&!y){p=false;q.fire("mouseexit",q,x)}}q.fire("mousemove",q,x)};this.click=function(u){if(p&&q._over(u)&&!s){q.fire("click",q,u)}s=false};this.dblclick=function(u){if(p&&q._over(u)&&!s){q.fire("dblclick",q,u)}s=false};this.mousedown=function(u){if(q._over(u)&&!o){o=true;t=m(a(q.canvas));q.fire("mousedown",q,u)}};this.mouseup=function(u){o=false;q.fire("mouseup",q,u)};this.contextmenu=function(u){if(p&&q._over(u)&&!s){q.fire("contextmenu",q,u)}s=false}};var c=function(p){var o=document.createElement("canvas");p._jsPlumb.appendElement(o,p.parent);o.style.position="absolute";if(p["class"]){o.className=p["class"]}p._jsPlumb.getId(o,p.uuid);if(p.tooltip){o.setAttribute("title",p.tooltip)}return o};var l=function(p){k.apply(this,arguments);var o=[];this.getDisplayElements=function(){return o};this.appendDisplayElement=function(q){o.push(q)}};var h=jsPlumb.CanvasConnector=function(r){l.apply(this,arguments);var o=function(v,t){p.ctx.save();jsPlumb.extend(p.ctx,t);if(t.gradient){var u=p.createGradient(v,p.ctx);for(var s=0;s<t.gradient.stops.length;s++){u.addColorStop(t.gradient.stops[s][0],t.gradient.stops[s][1])}p.ctx.strokeStyle=u}p._paint(v,t);p.ctx.restore()};var p=this,q=p._jsPlumb.connectorClass+" "+(r.cssClass||"");p.canvas=c({"class":q,_jsPlumb:p._jsPlumb,parent:r.parent,tooltip:r.tooltip});p.ctx=p.canvas.getContext("2d");p.appendDisplayElement(p.canvas);p.paint=function(w,t){if(t!=null){jsPlumb.sizeCanvas(p.canvas,w[0],w[1],w[2],w[3]);if(t.outlineColor!=null){var v=t.outlineWidth||1,s=t.lineWidth+(2*v),u={strokeStyle:t.outlineColor,lineWidth:s};o(w,u)}o(w,t)}}};var b=function(r){var p=this;l.apply(this,arguments);var q=p._jsPlumb.endpointClass+" "+(r.cssClass||""),o={"class":q,_jsPlumb:p._jsPlumb,parent:r.parent,tooltip:p.tooltip};p.canvas=c(o);p.ctx=p.canvas.getContext("2d");p.appendDisplayElement(p.canvas);this.paint=function(x,u,s){jsPlumb.sizeCanvas(p.canvas,x[0],x[1],x[2],x[3]);if(u.outlineColor!=null){var w=u.outlineWidth||1,t=u.lineWidth+(2*w);var v={strokeStyle:u.outlineColor,lineWidth:t}}p._paint.apply(this,arguments)}};jsPlumb.Endpoints.canvas.Dot=function(r){jsPlumb.Endpoints.Dot.apply(this,arguments);b.apply(this,arguments);var q=this,p=function(s){try{return parseInt(s)}catch(t){if(s.substring(s.length-1)=="%"){return parseInt(s.substring(0,s-1))}}},o=function(u){var s=q.defaultOffset,t=q.defaultInnerRadius;u.offset&&(s=p(u.offset));u.innerRadius&&(t=p(u.innerRadius));return[s,t]};this._paint=function(A,t,x){if(t!=null){var B=q.canvas.getContext("2d"),u=x.getOrientation(q);jsPlumb.extend(B,t);if(t.gradient){var v=o(t.gradient),y=u[1]==1?v[0]*-1:v[0],s=u[0]==1?v[0]*-1:v[0],z=B.createRadialGradient(A[4],A[4],A[4],A[4]+s,A[4]+y,v[1]);for(var w=0;w<t.gradient.stops.length;w++){z.addColorStop(t.gradient.stops[w][0],t.gradient.stops[w][1])}B.fillStyle=z}B.beginPath();B.arc(A[4],A[4],A[4],0,Math.PI*2,true);B.closePath();if(t.fillStyle||t.gradient){B.fill()}if(t.strokeStyle){B.stroke()}}}};jsPlumb.Endpoints.canvas.Rectangle=function(p){var o=this;jsPlumb.Endpoints.Rectangle.apply(this,arguments);b.apply(this,arguments);this._paint=function(x,r,v){var A=o.canvas.getContext("2d"),t=v.getOrientation(o);jsPlumb.extend(A,r);if(r.gradient){var z=t[1]==1?x[3]:t[1]==0?x[3]/2:0;var y=t[1]==-1?x[3]:t[1]==0?x[3]/2:0;var s=t[0]==1?x[2]:t[0]==0?x[2]/2:0;var q=t[0]==-1?x[2]:t[0]==0?x[2]/2:0;var w=A.createLinearGradient(s,z,q,y);for(var u=0;u<r.gradient.stops.length;u++){w.addColorStop(r.gradient.stops[u][0],r.gradient.stops[u][1])}A.fillStyle=w}A.beginPath();A.rect(0,0,x[2],x[3]);A.closePath();if(r.fillStyle||r.gradient){A.fill()}if(r.strokeStyle){A.stroke()}}};jsPlumb.Endpoints.canvas.Triangle=function(p){var o=this;jsPlumb.Endpoints.Triangle.apply(this,arguments);b.apply(this,arguments);this._paint=function(z,q,v){var s=z[2],C=z[3],B=z[0],A=z[1],D=o.canvas.getContext("2d"),w=0,u=0,t=0,r=v.getOrientation(o);if(r[0]==1){w=s;u=C;t=180}if(r[1]==-1){w=s;t=90}if(r[1]==1){u=C;t=-90}D.fillStyle=q.fillStyle;D.translate(w,u);D.rotate(t*Math.PI/180);D.beginPath();D.moveTo(0,0);D.lineTo(s/2,C/2);D.lineTo(0,C);D.closePath();if(q.fillStyle||q.gradient){D.fill()}if(q.strokeStyle){D.stroke()}}};jsPlumb.Endpoints.canvas.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.canvas.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Connectors.canvas.Bezier=function(){var o=this;jsPlumb.Connectors.Bezier.apply(this,arguments);h.apply(this,arguments);this._paint=function(q,p){o.ctx.beginPath();o.ctx.moveTo(q[4],q[5]);o.ctx.bezierCurveTo(q[8],q[9],q[10],q[11],q[6],q[7]);o.ctx.stroke()};this.createGradient=function(r,p,q){return o.ctx.createLinearGradient(r[6],r[7],r[4],r[5])}};jsPlumb.Connectors.canvas.Straight=function(){var p=this,o=[null,[1,-1],[1,1],[-1,1],[-1,-1]];jsPlumb.Connectors.Straight.apply(this,arguments);h.apply(this,arguments);this._paint=function(r,t){p.ctx.beginPath();if(t.dashstyle&&t.dashstyle.split(" ").length==2){var v=t.dashstyle.split(" ");if(v.length!=2){v=[2,2]}var C=[v[0]*t.lineWidth,v[1]*t.lineWidth],y=(r[6]-r[4])/(r[7]-r[5]),G=jsPlumbUtil.segment([r[4],r[5]],[r[6],r[7]]),x=o[G],u=Math.atan(y),z=Math.sqrt(Math.pow(r[6]-r[4],2)+Math.pow(r[7]-r[5],2)),B=Math.floor(z/(C[0]+C[1])),w=[r[4],r[5]];for(var A=0;A<B;A++){p.ctx.moveTo(w[0],w[1]);var q=w[0]+(Math.abs(Math.sin(u)*C[0])*x[0]),F=w[1]+(Math.abs(Math.cos(u)*C[0])*x[1]),E=w[0]+(Math.abs(Math.sin(u)*(C[0]+C[1]))*x[0]),D=w[1]+(Math.abs(Math.cos(u)*(C[0]+C[1]))*x[1]);p.ctx.lineTo(q,F);w=[E,D]}p.ctx.moveTo(w[0],w[1]);p.ctx.lineTo(r[6],r[7])}else{p.ctx.moveTo(r[4],r[5]);p.ctx.lineTo(r[6],r[7])}p.ctx.stroke()};this.createGradient=function(r,q){return q.createLinearGradient(r[4],r[5],r[6],r[7])}};jsPlumb.Connectors.canvas.Flowchart=function(){var o=this;jsPlumb.Connectors.Flowchart.apply(this,arguments);h.apply(this,arguments);this._paint=function(r,q){o.ctx.beginPath();o.ctx.moveTo(r[4],r[5]);for(var p=0;p<r[8];p++){o.ctx.lineTo(r[9+(p*2)],r[10+(p*2)])}o.ctx.lineTo(r[6],r[7]);o.ctx.stroke()};this.createGradient=function(q,p){return p.createLinearGradient(q[4],q[5],q[6],q[7])}};jsPlumb.Overlays.canvas.Label=jsPlumb.Overlays.Label;var g=function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments)};var e=function(p,o){p.apply(this,o);g.apply(this,o);this.paint=function(s,u,q,v,t){var r=s.ctx;r.lineWidth=q;r.beginPath();r.moveTo(u.hxy.x,u.hxy.y);r.lineTo(u.tail[0].x,u.tail[0].y);r.lineTo(u.cxy.x,u.cxy.y);r.lineTo(u.tail[1].x,u.tail[1].y);r.lineTo(u.hxy.x,u.hxy.y);r.closePath();if(v){r.strokeStyle=v;r.stroke()}if(t){r.fillStyle=t;r.fill()}}};jsPlumb.Overlays.canvas.Arrow=function(){e.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumb.Overlays.canvas.PlainArrow=function(){e.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumb.Overlays.canvas.Diamond=function(){e.apply(this,[jsPlumb.Overlays.Diamond,arguments])}})();(function(a){jsPlumb.CurrentLibrary={addClass:function(c,b){c=jsPlumb.CurrentLibrary.getElementObject(c);try{if(c[0].className.constructor==SVGAnimatedString){jsPlumb.util.svg.addClass(c[0],b)}}catch(d){}c.addClass(b)},animate:function(d,c,b){d.animate(c,b)},appendElement:function(c,b){jsPlumb.CurrentLibrary.getElementObject(b).append(c)},ajax:function(b){b=b||{};b.type=b.type||"get";a.ajax(b)},bind:function(b,c,d){b=jsPlumb.CurrentLibrary.getElementObject(b);b.bind(c,d)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},extend:function(c,b){return a.extend(c,b)},getAttribute:function(b,c){return b.attr(c)},getClientXY:function(b){return[b.clientX,b.clientY]},getDocumentElement:function(){return document},getDragObject:function(b){return b[1].draggable},getDragScope:function(b){return b.draggable("option","scope")},getDropEvent:function(b){return b[0]},getDropScope:function(b){return b.droppable("option","scope")},getDOMElement:function(b){if(typeof(b)=="string"){return document.getElementById(b)}else{if(b.context){return b[0]}else{return b}}},getElementObject:function(b){return typeof(b)=="string"?a("#"+b):a(b)},getOffset:function(b){return b.offset()},getOriginalEvent:function(b){return b.originalEvent},getPageXY:function(b){return[b.pageX,b.pageY]},getParent:function(b){return jsPlumb.CurrentLibrary.getElementObject(b).parent()},getScrollLeft:function(b){return b.scrollLeft()},getScrollTop:function(b){return b.scrollTop()},getSelector:function(b){return a(b)},getSize:function(b){return[b.outerWidth(),b.outerHeight()]},getTagName:function(b){var c=jsPlumb.CurrentLibrary.getElementObject(b);return c.length>0?c[0].tagName:null},getUIPosition:function(c){if(c.length==1){ret={left:c[0].pageX,top:c[0].pageY}}else{var d=c[1],b=d.offset;ret=b||d.absolutePosition}return ret},hasClass:function(c,b){return c.hasClass(b)},initDraggable:function(c,b,d){b=b||{};b.helper=null;if(d){b.scope=b.scope||jsPlumb.Defaults.Scope}c.draggable(b)},initDroppable:function(c,b){b.scope=b.scope||jsPlumb.Defaults.Scope;c.droppable(b)},isAlreadyDraggable:function(b){b=jsPlumb.CurrentLibrary.getElementObject(b);return b.hasClass("ui-draggable")},isDragSupported:function(c,b){return c.draggable},isDropSupported:function(c,b){return c.droppable},removeClass:function(c,b){c=jsPlumb.CurrentLibrary.getElementObject(c);try{if(c[0].className.constructor==SVGAnimatedString){jsPlumb.util.svg.removeClass(c[0],b)}}catch(d){}c.removeClass(b)},removeElement:function(b,c){jsPlumb.CurrentLibrary.getElementObject(b).remove()},setAttribute:function(c,d,b){c.attr(d,b)},setDraggable:function(c,b){c.draggable("option","disabled",!b)},setDragScope:function(c,b){c.draggable("option","scope",b)},setOffset:function(b,c){jsPlumb.CurrentLibrary.getElementObject(b).offset(c)},trigger:function(d,e,b){var c=jQuery._data(jsPlumb.CurrentLibrary.getElementObject(d)[0],"handle");c(b)},unbind:function(b,c,d){b=jsPlumb.CurrentLibrary.getElementObject(b);b.unbind(c,d)}};a(document).ready(jsPlumb.init)})(jQuery);(function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(l){return 0==l?0:0<l?1:-1});var d={subtract:function(m,l){return{x:m.x-l.x,y:m.y-l.y}},dotProduct:function(m,l){return m.x*l.x+m.y*l.y},square:function(l){return Math.sqrt(l.x*l.x+l.y*l.y)},scale:function(m,l){return{x:m.x*l,y:m.y*l}}},f=Math.pow(2,-65),h=function(y,x){for(var t=[],v=x.length-1,r=2*v-1,s=[],w=[],p=[],q=[],o=[[1,0.6,0.3,0.1],[0.4,0.6,0.6,0.4],[0.1,0.3,0.6,1]],u=0;u<=v;u++){s[u]=d.subtract(x[u],y)}for(u=0;u<=v-1;u++){w[u]=d.subtract(x[u+1],x[u]);w[u]=d.scale(w[u],3)}for(u=0;u<=v-1;u++){for(var m=0;m<=v;m++){p[u]||(p[u]=[]);p[u][m]=d.dotProduct(w[u],s[m])}}for(u=0;u<=r;u++){q[u]||(q[u]=[]);q[u].y=0;q[u].x=parseFloat(u)/r}r=v-1;for(s=0;s<=v+r;s++){u=Math.max(0,s-r);for(w=Math.min(s,v);u<=w;u++){j=s-u;q[u+j].y=q[u+j].y+p[j][u]*o[j][u]}}v=x.length-1;q=a(q,2*v-1,t,0);r=d.subtract(y,x[0]);p=d.square(r);for(u=o=0;u<q;u++){r=d.subtract(y,k(x,v,t[u],null,null));r=d.square(r);if(r<p){p=r;o=t[u]}}r=d.subtract(y,x[v]);r=d.square(r);if(r<p){p=r;o=1}return{location:o,distance:p}},a=function(C,B,x,z){var v=[],w=[],A=[],t=[],u=0,s,y;y=Math.sgn(C[0].y);for(var q=1;q<=B;q++){s=Math.sgn(C[q].y);s!=y&&u++;y=s}switch(u){case 0:return 0;case 1:if(z>=64){x[0]=(C[0].x+C[B].x)/2;return 1}var p,u=C[0].y-C[B].y;y=C[B].x-C[0].x;q=C[0].x*C[B].y-C[B].x*C[0].y;s=max_distance_below=0;for(p=1;p<B;p++){var r=u*C[p].x+y*C[p].y+q;r>s?s=r:r<max_distance_below&&(max_distance_below=r)}p=y;s=(1*(q-s)-p*0)*(1/(0*p-u*1));p=y;y=q-max_distance_below;u=(1*y-p*0)*(1/(0*p-u*1));y=Math.min(s,u);if(Math.max(s,u)-y<f){A=C[B].x-C[0].x;t=C[B].y-C[0].y;x[0]=0+1*(A*(C[0].y-0)-t*(C[0].x-0))*(1/(A*0-t*1));return 1}}k(C,B,0.5,v,w);C=a(v,B,A,z+1);B=a(w,B,t,z+1);for(z=0;z<C;z++){x[z]=A[z]}for(z=0;z<B;z++){x[z+C]=t[z]}return C+B},k=function(m,l,p,q,n){for(var o=[[]],r=0;r<=l;r++){o[0][r]=m[r]}for(m=1;m<=l;m++){for(r=0;r<=l-m;r++){o[m]||(o[m]=[]);o[m][r]||(o[m][r]={});o[m][r].x=(1-p)*o[m-1][r].x+p*o[m-1][r+1].x;o[m][r].y=(1-p)*o[m-1][r].y+p*o[m-1][r+1].y}}if(q!=null){for(r=0;r<=l;r++){q[r]=o[r][0]}}if(n!=null){for(r=0;r<=l;r++){n[r]=o[l-r][r]}}return o[l][0]},g={},e=function(t){var s=g[t];if(!s){var s=[],p=function(u){return function(){return u}},q=function(){return function(u){return u}},n=function(){return function(u){return 1-u}},o=function(u){return function(v){for(var x=1,w=0;w<u.length;w++){x=x*u[w](v)}return x}};s.push(new function(){return function(u){return Math.pow(u,t)}});for(var r=1;r<t;r++){for(var l=[new p(t)],m=0;m<t-r;m++){l.push(new q)}for(m=0;m<r;m++){l.push(new n)}s.push(new o(l))}s.push(new function(){return function(u){return Math.pow(1-u,t)}});g[t]=s}return s},c=function(m,l){for(var p=e(m.length-1),q=0,n=0,o=0;o<m.length;o++){q=q+m[o].x*p[o](l);n=n+m[o].y*p[o](l)}return{x:q,y:n}},b=function(m,l,p){for(var q=c(m,l),n=0,o=p>0?1:-1,r=null;n<Math.abs(p);){l=l+0.005*o;r=c(m,l);n=n+Math.sqrt(Math.pow(r.x-q.x,2)+Math.pow(r.y-q.y,2));q=r}return{point:r,location:l}},i=function(m,l){var o=c(m,l),p=c(m.slice(0,m.length-1),l),n=p.y-o.y,o=p.x-o.x;return n==0?Infinity:Math.atan(n/o)};window.jsBezier={distanceFromCurve:h,gradientAtPoint:i,gradientAtPointAlongCurveFrom:function(m,l,n){l=b(m,l,n);if(l.location>1){l.location=1}if(l.location<0){l.location=0}return i(m,l.location)},nearestPointOnCurve:function(m,l){var n=h(m,l);return{point:k(l,l.length-1,n.location,null,null),location:n.location}},pointOnCurve:c,pointAlongCurveFrom:function(m,l,n){return b(m,l,n).point},perpendicularToCurveAt:function(m,l,n,o){l=b(m,l,o==null?0:o);m=i(m,l.location);o=Math.atan(-1/m);m=n/2*Math.sin(o);n=n/2*Math.cos(o);return[{x:l.point.x+n,y:l.point.y+m},{x:l.point.x-n,y:l.point.y-m}]},locationAlongCurveFrom:function(m,l,n){return b(m,l,n).location}}})();